(this.webpackJsonp=this.webpackJsonp||[]).push([[18],{"HY+l":function(e,t,r){e.exports={project:"project--12mEX",user:"user--21Ktd",project_content_wrap:"project_content_wrap--Q6Yd8",project_content:"project_content--2IPzC",loading_icon:"loading_icon--2pNNb",portrait:"portrait--1Szbj",landscape:"landscape--27Iu-",title:"title--2k9TA",example:"example--3LB9P",v3:"v3--3aecP",coll:"coll--1XuK1","coll-author":"coll-author--1McoV","coll-label":"coll-label--3CbT5","coll-label-author":"coll-label-author--1F02u",label:"label--2K8ZP","tag-activity":"tag-activity--33ilM",en:"en--EIca3",text:"text--2oll3",icon:"icon--31p8s",update_time:"update_time--3YfTN",preview_img:"preview_img--1Kjdx",show:"show--9NAQ1",project_name_tooltip:"project_name_tooltip--31hxJ"}},X6Pd:function(e,t,r){e.exports={open_project:"open_project--2A0pu",show:"show--fpER0",tab_bar:"tab_bar--3rzDM",tab:"tab--26QNU",selected_tab:"selected_tab--uci33",selection_wrap:"selection_wrap--RPRXY",content_wrap:"content_wrap--1ni9Q",no_tab:"no_tab--1sHq6",content:"content--1Qj-f",sample_projects:"sample_projects--ZnPVY",empty_bg_placeholder:"empty_bg_placeholder--1oEec",project:"project--2HBz5",user:"user--2vK7F",project_content_wrap:"project_content_wrap--31b8a",project_content:"project_content--jFyP0",import_icon:"import_icon--ursRA",arrow:"arrow--3yWwX",computer:"computer--1LC1_",title:"title--1I0My",update_time:"update_time--1QdeI","local-project-file":"local-project-file--3IbOH",search_input_wrap:"search_input_wrap--3W_oo",search_icon:"search_icon--228x7",clear_icon:"clear_icon--1KN-g",search_input:"search_input--RLkn4"}},gMm4:function(e,t,r){e.exports={header:"header--3Zf6X",header_open_project:"header_open_project--WtCNl",header_create_project:"header_create_project--1_Wsd",open_project_icn:"open_project_icn--2grlE",create_project_icn:"create_project_icn--3oIEi","sample-dialog":"sample-dialog--3AVFg",active:"active--2769w",showDialog:"showDialog--zILY4"}},lAAk:function(e,t,r){e.exports={banner_wrap:"banner_wrap--N6WLH",banner_slider:"banner_slider--32dgK",banner:"banner--3Z5RY",controller:"controller--2PJhX",active:"active--1E8Zx",move_to_prev:"move_to_prev--mfhpP",curr_to_prev:"curr_to_prev--3UYpE",move_to_curr:"move_to_curr--3gNjP",next_to_curr:"next_to_curr--12gLN"}},"lTI/":function(e,t,r){"use strict";r.r(t),r.d(t,"ExampleDialogComponent",(function(){return Ae}));var o=r("o0o1"),n=r.n(o),a=r("yXPU"),c=r.n(a),s=r("lwsE"),i=r.n(s),_=r("W8MJ"),l=r.n(_),p=r("a1gu"),u=r.n(p),d=r("Nsbk"),m=r.n(d),h=r("7W2i"),b=r.n(h),j=r("q1tI"),g=r("2OET"),f=r("/MKj"),v=r("ANjH"),w=r("CG87"),y=r("G72A"),x=r("JcTc"),k=r("3b+z"),E=r("U/x8"),N=r("J4zp"),O=r.n(N),M=r("PJYZ"),L=r.n(M),I=r("qPyV"),A=r.n(I),C=r("3WF5"),P=r.n(C),S=r("J2m7"),R=r.n(S),K=r("wEy/"),z=r.n(K),X=r("BkRI"),Y=r.n(X),T=r("sEfC"),D=r.n(T),H=r("kNvX"),W=r.n(H),Z=r("6NTW"),q=r("Cu0f"),F=r("5IJ9"),J=r("e/E2"),Q=r("5nG9"),U=r("kTTF"),B=r("w0HH"),G=r("bdvc"),V=r("ptQL"),$=(r("lAAk"),{"./index.scss":{banner_wrap:"banner_wrap--N6WLH",banner_slider:"banner_slider--32dgK",banner:"banner--3Z5RY",controller:"controller--2PJhX",active:"active--1E8Zx",move_to_prev:"move_to_prev--mfhpP",curr_to_prev:"curr_to_prev--3UYpE",move_to_curr:"move_to_curr--3gNjP",next_to_curr:"next_to_curr--12gLN"}});var ee,te=function(e){function t(e){var r;return i()(this,t),(r=u()(this,m()(t).call(this,e))).slider_timer=void 0,r.render_slider_images=function(){return r.props.banners.map((function(e,t){return j.createElement("div",{key:t,"data-report-click":"作品弹窗-活动",onClick:function(t){var o;t.stopPropagation(),r.report_banner_detail("示例程序-banner-".concat(e.name)),Object(V.c)()?null===(o=Object(V.a)())||void 0===o||o.send("open-url",e.target_url):window.open(Object(G.O)(e.target_url))}},j.createElement("img",{src:e.background_url,className:W()(r.get_img_style(t),$,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})}))}))},r.render_controller_dots=function(){return r.props.play_carousel?r.props.banners.map((function(e,t){return j.createElement("span",{key:t,onClick:r.set_current_banner.bind(L()(r),t),className:W()(r.state.current_img===t?"active":"",$,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})})})):""},r.state={current_img:0},r}return b()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e=this;this.slider_timer=setInterval((function(){e.setState({current_img:(e.state.current_img+1)%e.props.banners.length})}),5e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.slider_timer)}},{key:"get_img_style",value:function(e){return this.props.play_carousel?this.state.current_img===e?"banner move_to_curr":"banner move_to_prev":"banner"}},{key:"report_banner_detail",value:function(e){this.props.reporter(e)}},{key:"set_current_banner",value:function(e){this.setState({current_img:e})}},{key:"clear_timer",value:function(){this.slider_timer&&clearInterval(this.slider_timer)}},{key:"set_timer",value:function(){var e=this;this.slider_timer=setInterval((function(){e.setState({current_img:(e.state.current_img+1)%e.props.banners.length})}),5e3)}},{key:"render",value:function(){return j.createElement("div",{className:"banner_wrap--N6WLH",onMouseEnter:this.clear_timer.bind(this),onMouseLeave:this.set_timer.bind(this)},j.createElement("div",{className:"banner_slider--32dgK"},this.render_slider_images()),j.createElement("div",{className:"controller--2PJhX"},this.render_controller_dots()))}}]),t}(j.Component),re=r("Gzrk"),oe=r("Vbab"),ne=r("AoQK"),ae=(r("HY+l"),{"./style.scss":{project:"project--12mEX",user:"user--21Ktd",project_content_wrap:"project_content_wrap--Q6Yd8",project_content:"project_content--2IPzC",loading_icon:"loading_icon--2pNNb",portrait:"portrait--1Szbj",landscape:"landscape--27Iu-",title:"title--2k9TA",example:"example--3LB9P",v3:"v3--3aecP",coll:"coll--1XuK1","coll-author":"coll-author--1McoV","coll-label":"coll-label--3CbT5","coll-label-author":"coll-label-author--1F02u",label:"label--2K8ZP","tag-activity":"tag-activity--33ilM",en:"en--EIca3",text:"text--2oll3",icon:"icon--31p8s",update_time:"update_time--3YfTN",preview_img:"preview_img--1Kjdx",show:"show--9NAQ1",project_name_tooltip:"project_name_tooltip--31hxJ"}});(function(e){e[e.Portrait=1]="Portrait",e[e.Landscape_4_3=2]="Landscape_4_3",e[e.Landscape_16_9=3]="Landscape_16_9"})(ee||(ee={}));var ce=function(e){function t(e){var r;return i()(this,t),(r=u()(this,m()(t).call(this,e))).is_catching_mouse=!1,r.current_mouse_position={x:0,y:0},r.catching_timer=void 0,r.current_work_name="",r.show_preview_img=function(){r.setState({show_preview:!0,show_loading_icon:!1})},r.hide_preview_img=function(){r.setState({show_preview:!1,start_loading_preview_img:!1,show_loading_icon:!1})},r.handle_mouse_enter=function(){r.setState({show_loading_icon:!0,start_loading_preview_img:!0})},r.stop_hover_timing=function(){r.is_catching_mouse=!1,clearTimeout(r.catching_timer),r.setState({hint_position:{left:0,top:0}})},r.start_hover_timing=function(e){r.is_catching_mouse=!0,r.current_work_name=e,r.catching_timer=setTimeout((function(){r.is_catching_mouse&&(r.is_catching_mouse=!1,r.setState({hint_position:{left:r.current_mouse_position.x+1,top:r.current_mouse_position.y+16}}))}),950)},r.handle_mouse_enter_project=function(e){r.current_mouse_position.x=e.nativeEvent.clientX,r.current_mouse_position.y=e.nativeEvent.clientY},r.note_mouse_position=function(e){r.is_catching_mouse&&(r.current_mouse_position.x=e.nativeEvent.clientX,r.current_mouse_position.y=e.nativeEvent.clientY)},r.get_sample_project=function(e){if(e){var t,o=e.title,n=e.background_url,a=e.type;return"example"===r.props.project_type&&(t={height:"100%",width:"100%"}),j.createElement("div",{className:"th1-border-impt-hover-0 project--12mEX"},j.createElement("div",{className:"th1-border-impt-7 project_content_wrap--Q6Yd8",onMouseEnter:r.handle_mouse_enter,onMouseLeave:r.hide_preview_img},j.createElement("div",{className:"project_content--2IPzC"},r.state.show_loading_icon&&j.createElement("span",{className:"loading_icon--2pNNb"},j.createElement(re.f,{size:40,theme_color:"0"})),j.createElement("img",{style:t,src:Object(q.e)(n),alt:"project_img"}),j.createElement("img",{src:r.state.start_loading_preview_img?Object(q.e)(e.preview_url)+"?imageMogr2/thumbnail/!200x200r/blur/1x0/quality/100|imageslim":"",alt:"preview_img",onLoad:r.show_preview_img,className:W()("preview_img ".concat(r.state.show_preview?"show":""),ae,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})}),"user"===r.props.project_type&&j.createElement("span",{className:"th1-text-t7 "+W()("title ".concat(r.props.project_type),ae,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},Object(q.e)(o)),a===q.d.Activity&&j.createElement("div",{className:W()("tag-activity ".concat("en"===Object(oe.e)()?"en":""),ae,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},j.createElement("span",{className:"icon--31p8s"},j.createElement(re.c,{id:"#icon_activity_tag",size:70,class_name:"th1-text-0"})),j.createElement("span",{className:"text--2oll3"},r.props.intl.formatMessage({id:"project/activity"}))))))}},r.format_update_time=function(e,t){var o,n,a=new Date(1e3*t);o="Today"===e||"Yesterday"===e||"TDBY"===e?e:"".concat(a.getFullYear(),"/").concat(a.getMonth()+1,"/").concat(a.getDate());var c=(new Date).getTime()-1e3*t;if("Today"===e&&c<=216e5){var s,i=Math.floor(c/36e5),_=Math.floor(c%36e5/6e4),l=i?"".concat(i).concat(r.props.intl.formatMessage({id:"project/hour"})):"";s=_?"".concat(_).concat(r.props.intl.formatMessage({id:"project/minute"})):"",i||_||(s="1".concat(r.props.intl.formatMessage({id:"project/minute"}))),n="".concat(l).concat(s).concat(r.props.intl.formatMessage({id:"project/ago"})),o=""}else n="".concat(a.getHours(),":").concat(r.get_minutes(a.getMinutes()));return"".concat(r.get_day(o)," ").concat(n)},r.get_minutes=function(e){return 0===e?"00":e<10?"0".concat(e):e},r.get_user_project=function(e){if(e){var t=e.id,o=e.preview_url,n=e.name,a=e.orientation,c=e.date_desc,s=e.updated_time,i=e.cover_url,_=r.format_update_time(c,s),l=r.props.is_coll&&r.props.role===B.b.Author;return j.createElement("div",{className:"th1-border-impt-hover-0 project--12mEX user--21Ktd",onClick:r.open_user_project.bind(L()(r),t),onMouseEnter:r.handle_mouse_enter_project.bind(L()(r)),onMouseOver:r.start_hover_timing.bind(L()(r),n),onMouseMove:r.note_mouse_position,onMouseOut:r.stop_hover_timing,"data-report-click":"作品弹窗-(".concat("file-new"===Object(E.a)()?"新建":"打开",")打开作品")},j.createElement("div",{className:"th1-border-impt-7 project_content_wrap--Q6Yd8"},j.createElement("div",{className:"th1-bg-8 project_content--2IPzC"},j.createElement("img",{src:i||o,alt:"project_img",className:W()(a===ee.Portrait?"portrait":"landscape",ae,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})}),r.props.is_coll&&j.createElement("span",{className:W()("coll-label ".concat(l?"coll-label-author":""),ae,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},l&&j.createElement(re.c,{id:"#iconicn_team",margin:"0 1px 0 0",size:12}),r.props.intl.formatMessage({id:"coll/collaboration"})),j.createElement("span",{className:"th1-text-t7 "+W()("title ".concat(r.props.project_type,"\n                 ").concat(r.props.is_v3?"v3":""," \n                 ").concat(r.props.is_coll?"coll":"","\n                 ").concat(l?"coll-author":"","\n                 "),ae,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},n),r.props.is_v3&&j.createElement("span",{className:"label--2K8ZP"},"V3.0"),j.createElement("span",{className:"th1-text-t7 update_time--3YfTN"},_),r.state.hint_position.left?j.createElement("p",{className:"project_name_tooltip--31hxJ",style:{top:"".concat(r.state.hint_position.top,"px"),left:"".concat(r.state.hint_position.left,"px")}},r.current_work_name):"")))}},r.state={show_preview:!1,start_loading_preview_img:!1,show_loading_icon:!1,hint_position:{left:0,top:0}},r}return b()(t,e),l()(t,[{key:"componentWillUnmount",value:function(){clearTimeout(this.catching_timer)}},{key:"open_user_project",value:function(e){var t=this;this.props.action_set_project_info_state({base_sample_project_id:""}),Object(F.is_unsave_bcm)()?(this.props.close_dialog({dialog_type:"example"}),Object(F.set_task_func)((function(){t.open_project_callback(e)})),Object(F.add_unsave_hint)()):this.open_project_callback(e)}},{key:"open_project_callback",value:function(e){var t=this,r=Object(V.b)();if(r&&r.clear_path(),this.props.is_v3)return this.props.close_dialog({dialog_type:"example"}),this.props.set_open_v3_dialog({open_callback:function(){sessionStorage.direct_open=!0,t.props.action_fetch_bcm_urls_by_id({id:e})},new_copy_callback:function(){sessionStorage.copy=!0,t.props.action_fetch_bcm_urls_by_id({id:e})}}),void this.props.show_dialog({dialog_type:"open_v3"});this.props.close_dialog({dialog_type:"example"}),this.props.action_fetch_bcm_urls_by_id({id:e})}},{key:"get_day",value:function(e){return"Today"===e||"Yesterday"===e||"TDBY"===e?this.props.intl.formatMessage({id:"project/".concat(e)}):e}},{key:"render",value:function(){var e=this.props,t=e.sample_project_info,r=e.user_project_info;return"example"===this.props.project_type?this.get_sample_project(t):this.get_user_project(r)}}]),t}(j.Component);var se=Object(g.b)(Object(f.connect)(void 0,(function(e){return Object(v.bindActionCreators)({close_dialog:y.c,show_dialog:y.g,set_dialog_props:y.f,action_fetch_bcm_by_url:U.b,action_fetch_bcm_urls_by_id:U.c,action_set_project_info_state:B.c,set_open_v3_dialog:ne.b},e)}))(ce)),ie=r("O8UM"),_e=r("lgdi"),le=r("7zTG"),pe=r("1vbn"),ue=(r("nrOc"),{"./style.scss":{create_project:"create_project--1JMIa",show:"show--1r8Zx",project_tab_bar:"project_tab_bar--ZR0qa",project_tab:"project_tab--1N4Xz",content_wrap:"content_wrap--dspLS",content:"content--wAh4o",tab_all:"tab_all--3kOJU",sample_projects:"sample_projects--ibz1C",project_component_wrap:"project_component_wrap--1Fpji",blank_project:"blank_project--nK-LD",add_blank_project_wrap:"add_blank_project_wrap--OEN1r",add_blank_project:"add_blank_project--3j-6d",add_button:"add_button--35hIn",icon:"icon--9Zmvp",title:"title--10TAK",blank_area:"blank_area--3ut9N",top_three_projects:"top_three_projects--3XGri",example_group:"example_group--1XY-U",group_title:"group_title--1a2H5"}});var de=function(e){function t(e){var r;return i()(this,t),(r=u()(this,m()(t).call(this,e))).content=void 0,r.content_wrap=void 0,r.debounced_load_next_page_projects=D()(r.load_next_page_projects.bind(L()(r)),150),r.current_group_index=0,r.current_group_page=0,r.current_filtered_page=0,r.is_filtered_projects_all_loaded=!1,r.is_requesting=!1,r.offline_demo_projects=void 0,r.open_sample_project=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";r.props.close_dialog({dialog_type:"example"}),r.props.action_set_project_info_state({base_sample_project_id:t}),Object(pe.l)(e?pe.a.SAMPLE:pe.a.ORIGIN);var o=function(){var t=Object(V.b)();t&&t.clear_path(),e?r.props.action_fetch_bcm_by_url({url:e}):r.props.action_load_bcm_json({bcm_json:Object(_e.a)()})};Object(F.is_unsave_bcm)()?(Object(F.set_task_func)(o),Object(F.add_unsave_hint)()):o()},r.open_blank_project=function(){r.open_sample_project()},r.on_group_click=function(e){r.is_requesting||r.state.selected_group_index!==e&&r.setState({selected_group_index:e,filtered_projects:[]},(function(){r.current_filtered_page=0,r.is_filtered_projects_all_loaded=!1,0!==e&&r.load_next_page_projects(!0)}))},r.is_default_group=function(){return 0===r.state.selected_group_index},r.sample_project_data_report=function(e){var t=e.id,o=Object(q.e)(r.state.groups[r.state.selected_group_index].name,"zh"),n=e.first_level_label&&e.first_level_label[0]||"",a=e.second_level_label&&e.second_level_label[0]||"",c=r.is_default_group()?r.current_group_page:r.current_filtered_page;Object(J.B)("sample_product_label_click",{first_label:n,second_label:a,exposed_location:o,exposed_page:c+1,element_type:"sample",element_id:t})},r.on_sample_project_click=function(e,t){Object(J.m)("作品弹窗-（".concat("file-new"===Object(E.a)()?"新建":"打开","）打开示例程序")),"example"===t&&r.sample_project_data_report(e);var o=r.handle_bcm_url(e.bcm_url);r.open_sample_project(o,e.id)},r.load_default_group_projects=c()(n.a.mark((function e(){var t,o,a,c,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(V.d)()&&r.offline_demo_projects&&(t=[{label_id:"5190",projects:r.offline_demo_projects.items.slice(3)}],r.setState({project_groups:t})),o=r.state.groups[r.is_default_group()?r.current_group_index+1:r.current_group_index]){e.next=4;break}throw Error("ALL_LOADED");case 4:return e.next=6,Object(Z.e)({category_id:o.label_id,category_name:o.name,page:r.current_group_page});case 6:a=e.sent,(c=Y()(r.state.project_groups))[r.current_group_index]||(c[r.current_group_index]={label_id:o.label_id,projects:[]}),s=c[r.current_group_index],a.offset+a.limit>=a.total?(r.current_group_page=0,r.current_group_index++):r.current_group_page++,z()(a.items,(function(e){return!!R()(r.state.top_three_projects,(function(t){return t.id===e.id}))})),s.projects=s.projects.concat(a.items),r.setState({project_groups:c});case 15:case"end":return e.stop()}}),e)}))),r.load_filtered_group_projects=c()(n.a.mark((function e(){var t,o;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.is_filtered_projects_all_loaded){e.next=2;break}throw Error("ALL_LOADED");case 2:return t=r.state.groups[r.state.selected_group_index],e.next=5,Object(Z.e)({category_id:t.label_id,category_name:t.name,page:r.current_filtered_page});case 5:o=e.sent,r.is_filtered_projects_all_loaded=o.offset+o.limit>=o.total,r.current_filtered_page++,r.setState({filtered_projects:Y()(r.state.filtered_projects).concat(o.items)});case 9:case"end":return e.stop()}}),e)}))),r.state={project_groups:[],filtered_projects:[],selected_group_index:0,top_three_projects:[],banners:[],groups:[]},r}var r,o;return b()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.init_dialog()}},{key:"init_dialog",value:(o=c()(n.a.mark((function e(){var t,r,o,a,c,s,i,_=this;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!Object(V.d)()){e.next=8;break}return e.next=4,Promise.all([Object(Z.d)(),Object(Z.c)(),Object(Z.a)()]);case 4:t=e.sent,this.offline_demo_projects=t[2],e.next=11;break;case 8:return e.next=10,Promise.all([Object(Z.d)(),Object(Z.c)(),Object(Z.g)()]);case 10:t=e.sent;case 11:console.log(t),r=t,o=O()(r,3),a=o[0],c=o[1],s=o[2],i=s.items.slice(0,3),this.setState({groups:a,selected_group_index:0,banners:c,top_three_projects:i},(function(){_.load_next_page_projects(!0)})),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0);case 20:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(){return o.apply(this,arguments)})},{key:"is_play_carousel",value:function(e){return e.length>1}},{key:"report_banner_click_event",value:function(e){var t={element_type:"banner",element_id:e};return Object(J.B)("sample_product_label_click",t)}},{key:"handle_bcm_url",value:function(e){var t=Object(q.e)(e);if(Object(V.d)())return t;if(/^(https?:)?\/\/.+/.test(t))return t;this.props.show_toast({content:"example_dialog/incorrect_url",type:"notice"})}},{key:"load_next_page_projects",value:(r=c()(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.is_requesting){e.next=2;break}return e.abrupt("return");case 2:if(t||Object(G.C)(this.content_wrap,this.content)){e.next=4;break}return e.abrupt("return");case 4:if(e.prev=4,this.is_requesting=!0,!this.is_default_group()){e.next=11;break}return e.next=9,this.load_default_group_projects();case 9:e.next=13;break;case 11:return e.next=13,this.load_filtered_group_projects();case 13:this.is_requesting=!1,this.load_next_page_projects(),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(4),"ALL_LOADED"!==e.t0.message&&console.log(e.t0),this.is_requesting=!1;case 21:case"end":return e.stop()}}),e,this,[[4,17]])}))),function(e){return r.apply(this,arguments)})},{key:"render_groups",value:function(){var e=this;return j.createElement("div",{className:"project_tab_bar--ZR0qa"},this.state.groups.map((function(t,r){var o=e.state.selected_group_index===r;return j.createElement("span",{key:t.id,className:"\n                  ".concat(o?"th1-bg-1 th1-text-10":"th1-bg-7 th1-bg-hover-4 ".concat(e.props.theme.light_theme_colors?"th1-text-t5":"th1-text-1"," th1-text-hover-m1 th1-text-hover-s2"),"\n                ")+" project_tab--1N4Xz",onClick:e.on_group_click.bind(e,r)},Object(q.e)(t.name))})))}},{key:"render_blank_project",value:function(){return j.createElement("div",{className:"blank_project--nK-LD","data-report-click":"作品弹窗-空白作品",onClick:this.open_blank_project},j.createElement("div",{className:"th1-border-impt-hover-0 add_blank_project_wrap--OEN1r"},j.createElement("div",{className:"th1-bg-8 th1-border-impt-7 "+W()("add_blank_project ".concat(this.is_default_group()&&this.props.enable_banner?"tab_all":""),ue,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},j.createElement("div",{className:"add_button--35hIn"},j.createElement("span",{className:("".concat(Object(ie.d)("th1-bg-5",this.props.theme,4))?"".concat(Object(ie.d)("th1-bg-5",this.props.theme,4))+" ":"")+"icon--9Zmvp"},j.createElement(x.a,{id:"#iconicon_add",size:24,class_name:"th1-text-0 th1-text-s2"})),j.createElement("span",{className:"th1-text-0 th1-text-s2"},this.props.intl.formatMessage({id:"project/create_blank_project"}))))))}},{key:"render_projects",value:function(e){var t=this;return e?P()(A()(e,"id"),(function(e){return j.createElement("div",{className:"project_component_wrap--1Fpji",key:e.id,onClick:t.on_sample_project_click.bind(t,e,"example"),"data-report-click":"作品弹窗-选中示例程序"},j.createElement(se,{sample_project_info:e,project_type:"example",create_project_tab:t.state.selected_group_index}))})):""}},{key:"render_all_projects",value:function(){var e=this;return j.createElement(j.Fragment,null,this.is_default_group()&&j.createElement("div",{className:"top_three_projects--3XGri"},this.render_projects(this.state.top_three_projects)),P()(this.state.project_groups,(function(t){console.log(t.projects);var r=R()(e.state.groups,(function(e){return e.label_id===t.label_id}));return j.createElement("div",{className:"example_group--1XY-U",key:t.label_id},j.createElement("div",{className:"group_title--1a2H5"},r?Object(q.e)(r.name):"-"),e.render_projects(t.projects))})))}},{key:"render_filtered_projects",value:function(){return this.render_projects(this.state.filtered_projects)}},{key:"render_contents",value:function(){var e=this,t=this.is_default_group();return j.createElement("div",{className:"content_wrap--dspLS",ref:function(t){t&&(e.content_wrap=t)},onScroll:this.debounced_load_next_page_projects},j.createElement("div",{ref:function(t){t&&(e.content=t)},className:W()("content ".concat(t&&this.props.enable_banner?"tab_all":""),ue,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},this.render_blank_project(),t&&this.props.enable_banner&&j.createElement(te,{banners:this.state.banners,play_carousel:this.is_play_carousel(this.state.banners),reporter:this.report_banner_click_event.bind(this)}),j.createElement("div",{className:"sample_projects--ibz1C"},j.createElement("div",{className:"blank_area--3ut9N"}),t?this.render_all_projects():this.render_filtered_projects())))}},{key:"render",value:function(){return j.createElement("div",{className:W()("create_project ".concat(this.props.is_show_open_project?"":"show"),ue,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},this.render_groups(),this.render_contents())}}]),t}(j.Component);var me,he=Object(g.b)(Object(f.connect)((function(e){return{theme:e.common_state.theme,enable_banner:e.common_state.ui_cfg.new_file_dialog.banner}}),(function(e){return Object(v.bindActionCreators)({show_toast:Q.d,close_dialog:y.c,action_fetch_bcm_by_url:U.b,action_load_bcm_json:le.d,action_set_project_info_state:B.c},e)}))(de)),be=r("RIqP"),je=r.n(be),ge=r("lSNA"),fe=r.n(ge),ve=r("5FhS"),we=r("2pfL"),ye=r("CZH1"),xe=r("xfAC"),ke=(r("X6Pd"),{"./style.scss":{open_project:"open_project--2A0pu",show:"show--fpER0",tab_bar:"tab_bar--3rzDM",tab:"tab--26QNU",selected_tab:"selected_tab--uci33",selection_wrap:"selection_wrap--RPRXY",content_wrap:"content_wrap--1ni9Q",no_tab:"no_tab--1sHq6",content:"content--1Qj-f",sample_projects:"sample_projects--ZnPVY",empty_bg_placeholder:"empty_bg_placeholder--1oEec",project:"project--2HBz5",user:"user--2vK7F",project_content_wrap:"project_content_wrap--31b8a",project_content:"project_content--jFyP0",import_icon:"import_icon--ursRA",arrow:"arrow--3yWwX",computer:"computer--1LC1_",title:"title--1I0My",update_time:"update_time--1QdeI","local-project-file":"local-project-file--3IbOH",search_input_wrap:"search_input_wrap--3W_oo",search_icon:"search_icon--228x7",clear_icon:"clear_icon--1KN-g",search_input:"search_input--RLkn4"}});var Ee,Ne=[{i18n:"project_dialog/all",id:q.c.All,data_report:"全部"},{i18n:"project_dialog/published",id:q.c.Published,data_report:"已发布"},{i18n:"project_dialog/unpublished",id:q.c.UnPublished,data_report:"未发布"}];!function(e){e[e.ALL=1]="ALL",e[e.K4=4]="K4",e[e.K3=3]="K3"}(Ee||(Ee={}));var Oe=(me={},fe()(me,Ee.ALL,"manage_project/all_version"),fe()(me,Ee.K4,"manage_project/version_4"),fe()(me,Ee.K3,"manage_project/version_3"),me),Me=function(e){function t(e){var r;return i()(this,t),(r=u()(this,m()(t).call(this,e))).search_keyword=void 0,r.content_wrap=void 0,r.content=void 0,r.file_input=void 0,r.version_selection=void 0,r.debounced_load_more_project_page=D()(r.load_more_content.bind(L()(r)),150),r.debounced_search_function=D()((function(e){r.fetch_project_by_name(e)}),700),r.init=function(){r.state.project_list.length||r.fetch_projects()},r.get_context_menu_item=function(){return[r.create_menu_item(Oe[Ee.ALL],Ee.ALL),r.create_menu_item(Oe[Ee.K4],Ee.K4),r.create_menu_item(Oe[Ee.K3],Ee.K3)]},r.create_menu_item=function(e,t){var o={text:""};return o.text=e,o.on_click=r.select_version.bind(L()(r),Number(t)),o.style={justifyContent:"flex-start",width:"98px"},o.data_report="打开作品-版本选择",o.checked=r.state.selected_version===t,o},r.this_time_load_project_list=[],r.is_scroll_to_bottom=function(){if(r.content_wrap&&r.content){var e=r.content_wrap.getBoundingClientRect(),t=r.content.getBoundingClientRect(),o=e.bottom,n=t.bottom,a=e.height;return!!(t.height-a>0&&n-o<=10)}},r.get_tab_bar=function(){return j.createElement("div",{className:"tab_bar--3rzDM"},j.createElement("div",{className:"selection_wrap--RPRXY",ref:function(e){e&&(r.version_selection=e)}},j.createElement(re.b,{direction:"down",width:"98px",height:"28px",value:Oe[r.state.selected_version],on_click:r.handle_selection_click.bind(L()(r))})),Ne.map((function(e){return j.createElement("span",{key:e.id,onClick:r.select_project_type.bind(L()(r),e.id),"data-report-click":"作品弹窗-".concat(e.data_report),className:"th1-bg-7 th1-bg-selected-1\n              ".concat(Object(ie.d)("th1-bg-hover-6",r.props.theme),"\n              ").concat(r.props.theme.light_theme_colors?"th1-text-t5 th1-text-hover-s2 th1-text-selected-s2":"th1-text-1 th1-text-hover-m1 th1-text-selected-m1","\n              ").concat(r.state.project_type===e.id?"selected":"","\n            ")+" "+W()("tab ".concat(r.state.project_type!==e.id||r.props.theme.light_theme_colors?"":"selected_tab"),ke,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},r.props.intl.messages[e.i18n])})),r.render_search_input())},r.render_search_input=function(){return j.createElement("div",{className:"search_input_wrap--3W_oo"},j.createElement(ve.a,{clearBtn:!0,iconsPrefix:j.createElement(x.a,{id:"#iconicon-search",size:14,class_name:"th1-text-t3"}),placeholder:r.props.intl.formatMessage({id:"project/search_projects"}),onChange:r.set_search_input,value:r.state.search_keyword,maxLength:20}))},r.import_project=function(e){e.stopPropagation(),r.file_input.click()},r.load_project=function(e){var t=e.target.files[0];Object(F.is_unsave_bcm)()?(r.props.close_dialog({dialog_type:"example"}),Object(F.set_task_func)((function(){r.load_project_callback(t)})),Object(F.add_unsave_hint)()):r.load_project_callback(t)},r.render_local_project=function(){return j.createElement("div",{className:"th1-border-impt-hover-0 project--2HBz5 user--2vK7F",onClick:r.import_project,"data-report-click":"作品弹窗-打开本地作品"},j.createElement("div",{className:"th1-border-impt-7 project_content_wrap--31b8a"},j.createElement("div",{className:"th1-bg-8 project_content--jFyP0"},j.createElement("div",{className:"import_icon--ursRA"},j.createElement("span",{className:"arrow--3yWwX"},j.createElement(x.a,{id:"#icon_import_arrow",size:20,class_name:"th1-text-0 th1-text-s2"})),j.createElement("span",{className:"computer--1LC1_"},j.createElement(x.a,{id:"#icon_import_computer",size:55,class_name:"".concat(Object(ie.d)("th1-text-5",r.props.theme,4))})),j.createElement("span",{className:"th1-text-0 th1-text-s2"},r.props.intl.formatMessage({id:"project/local_project"}))),j.createElement("input",{type:"file",className:"local-project-file--3IbOH",onChange:r.load_project,ref:function(e){e&&(r.file_input=e)},accept:".bcm, .bcm4"}),j.createElement("span",{className:"th1-text-t7 title--1I0My"},r.props.intl.formatMessage({id:"project/import_local_project"})))))},r.set_search_input=function(e){r.search_keyword=e.target.value,r.setState({search_keyword:r.search_keyword,selected_version:Ee.ALL}),r.debounced_search_function(r.search_keyword)},r.state={search_keyword:"",project_total_number:0,project_list:[],project_page:1,project_loaded:!1,project_type:q.c.All,selected_version:Ee.ALL},r}var r;return b()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.init()}},{key:"select_project_type",value:function(e){var t=this,r="作品弹窗-".concat(this.report_project_type_select(e));Object(J.m)(r),e!==this.state.project_type&&(this.search_keyword="",this.setState({search_keyword:"",project_list:[],project_page:1,project_loaded:!1,project_type:e},(function(){t.fetch_projects()})))}},{key:"handle_selection_click",value:function(){if(this.version_selection){var e=this.version_selection.getBoundingClientRect(),t=e.left,r=e.bottom;this.props.show_context_menu({x:t,y:r+5,menu_items:this.get_context_menu_item()})}}},{key:"select_version",value:function(e){var t=this;this.search_keyword="",this.setState({selected_version:e,search_keyword:"",project_list:[],project_page:1,project_loaded:!1},(function(){return t.fetch_projects()}));var r=document.activeElement;r&&r.blur()}},{key:"report_project_type_select",value:function(e){switch(e){case q.c.All:return"全部";case q.c.Published:return"已发布";case q.c.UnPublished:return"未发布";default:return}}},{key:"fetch_projects",value:(r=c()(n.a.mark((function e(t){var r,o,a,c,s,i,_;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Z.f(this.state.project_type,t||this.state.project_page,this.search_keyword,this.state.selected_version);case 3:if((r=e.sent)&&r.project_list){e.next=6;break}return e.abrupt("return");case 6:if(o=r.project_list,a=r.project_page,c=r.project_total_number,s=this.state.project_list,i=je()(s).concat(je()(o)),_=i.length>=c,this.this_time_load_project_list=this.this_time_load_project_list.concat(o),this.setState({project_list:i,project_loaded:_,project_page:a}),!(!_&&this.this_time_load_project_list.length<8&&o.length>0)){e.next=15;break}return this.fetch_projects(a),e.abrupt("return");case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(0);case 20:this.this_time_load_project_list=[];case 21:case"end":return e.stop()}}),e,this,[[0,17]])}))),function(e){return r.apply(this,arguments)})},{key:"load_more_content",value:function(){!this.is_scroll_to_bottom()||this.state.project_loaded||this.fetch_projects()}},{key:"load_project_callback",value:function(e){if(/.*\.bcm4?$/.test(e.name)){var t=Object(V.b)();t&&t.clear_path(),t&&t.set_path(e.path),this.props.close_dialog({dialog_type:"example"}),this.props.action_load_bcm_by_file({file:e})}else this.props.show_toast({content:"bcm_type_error",type:"error"})}},{key:"fetch_project_by_name",value:function(e){var t=this,r=Object(we.b)(e);(r===e||r)&&(this.search_keyword=r,this.setState({project_list:[],project_page:1,project_loaded:!1},(function(){t.fetch_projects()})),Object(J.m)("作品弹窗-搜索作品"))}},{key:"get_content",value:function(){var e=this;return j.createElement("div",{ref:function(t){t&&(e.content_wrap=t)},onScroll:this.debounced_load_more_project_page,className:W()("content_wrap ".concat(""),ke,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},j.createElement("div",{className:"content--1Qj-f",ref:function(t){t&&(e.content=t)}},""===this.state.search_keyword&&this.render_local_project(),this.state.project_list&&this.state.project_list.map((function(e){return j.createElement(se,{key:e.id,user_project_info:e,project_type:"user",is_v3:!e.version,is_coll:e.is_coll_work,role:e.role})})),""!==this.state.search_keyword&&(!this.state.project_list||!this.state.project_list.length)&&j.createElement("div",{className:"empty_bg_placeholder--1oEec"},j.createElement(xe.a,{text:this.props.intl.formatMessage({id:"open_project/empty_notice"})}))))}},{key:"render",value:function(){return j.createElement("div",{className:W()("open_project ".concat(this.props.is_show_open_project?"show":""),ke,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},this.get_tab_bar(),this.get_content())}}]),t}(j.Component);var Le=Object(g.b)(Object(f.connect)((function(e){return{theme:e.common_state.theme}}),(function(e){return Object(v.bindActionCreators)({close_dialog:y.c,show_toast:Q.d,action_load_bcm_by_file:le.b,show_context_menu:ye.d},e)}))(Me));r("gMm4");var Ie=function(e){function t(e){var r;return i()(this,t),(r=u()(this,m()(t).call(this,e))).on_request_close=function(){r.props.close_dialog({dialog_type:"example"})},r.on_header_tab_click=function(){var e=c()(n.a.mark((function e(t){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.state.is_show_open_project!==t){e.next=2;break}return e.abrupt("return");case 2:r.props.is_login?r.setState({is_render_create_project:!0,is_render_open_project:!0,is_show_open_project:t}):(r.on_request_close(),r.props.show_dialog({dialog_type:"sign_in"}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.state={is_show_open_project:"file-open"===Object(E.a)(),is_render_open_project:"file-open"===Object(E.a)(),is_render_create_project:"file-new"===Object(E.a)()},r}return b()(t,e),l()(t,[{key:"get_header",value:function(){return j.createElement("div",{className:"header--3Zf6X"},this.props.enable_new_file&&j.createElement("div",{"data-report-click":"作品弹窗-切换到新建作品",className:"\n                ".concat(this.props.theme.light_theme_colors?"th1-border-impt-selected-s2 th1-text-t3 th1-text-selected-s2 th1-text-hover-s2":"th1-text-3 th1-text-selected-0 th1-border-impt-selected-0 th1-text-hover-0","\n                ").concat(this.state.is_show_open_project?"":"selected","\n              ")+" header_create_project--1_Wsd",onClick:this.on_header_tab_click.bind(this,!1)},j.createElement(x.a,{id:"#icon_create_project",size:18,margin:"0 6px 0 0"}),this.props.intl.formatMessage({id:"project_dialog/create_project"})),this.props.enable_open_file&&j.createElement("div",{"data-report-click":"作品弹窗-切换到打开作品",className:"\n            ".concat(this.props.theme.light_theme_colors?"th1-border-impt-selected-s2 th1-text-t3 th1-text-selected-s2 th1-text-hover-s2":"th1-text-3 th1-text-selected-0 th1-border-impt-selected-0 th1-text-hover-0","\n            ").concat(this.state.is_show_open_project?"selected":"","\n          ")+" header_open_project--WtCNl",onClick:this.on_header_tab_click.bind(this,!0)},j.createElement(x.a,{id:"#icon_open_project",size:18,margin:"0 6px 0 0"}),this.props.intl.formatMessage({id:"project_dialog/open_project"})))}},{key:"render",value:function(){return j.createElement(w.a,{type:"example",on_request_close:this.on_request_close,close_btn:{style:{top:21,right:15},icon_id:"#iconicon_close",icon_size:16}},j.createElement("div",{className:"sample-dialog--3AVFg"},this.get_header(),this.state.is_render_create_project&&j.createElement(he,{is_show_open_project:this.state.is_show_open_project}),this.state.is_render_open_project&&j.createElement(Le,{is_show_open_project:this.state.is_show_open_project})))}}]),t}(j.Component);var Ae=Object(g.b)(Object(f.connect)((function(e){return{theme:e.common_state.theme,is_login:e.userinfo_state.is_login,enable_new_file:e.common_state.ui_cfg.new_file,enable_open_file:e.common_state.ui_cfg.open_file}}),(function(e){return Object(v.bindActionCreators)({close_dialog:y.c,show_dialog:y.g,show_toast:k.c},e)}))(Ie))},lWPa:function(e,t,r){e.exports={placehold_image:"placehold_image--O4xbF"}},nrOc:function(e,t,r){e.exports={create_project:"create_project--1JMIa",show:"show--1r8Zx",project_tab_bar:"project_tab_bar--ZR0qa",project_tab:"project_tab--1N4Xz",content_wrap:"content_wrap--dspLS",content:"content--wAh4o",tab_all:"tab_all--3kOJU",sample_projects:"sample_projects--ibz1C",project_component_wrap:"project_component_wrap--1Fpji",blank_project:"blank_project--nK-LD",add_blank_project_wrap:"add_blank_project_wrap--OEN1r",add_blank_project:"add_blank_project--3j-6d",add_button:"add_button--35hIn",icon:"icon--9Zmvp",title:"title--10TAK",blank_area:"blank_area--3ut9N",top_three_projects:"top_three_projects--3XGri",example_group:"example_group--1XY-U",group_title:"group_title--1a2H5"}},xfAC:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var o=r("q1tI"),n=r.n(o);r("lWPa");var a=function(e){return n.a.createElement("div",{className:"placehold_image--O4xbF"},n.a.createElement("span",{className:"th1-text-1 th1-text-s2"},e.text))}}}]);
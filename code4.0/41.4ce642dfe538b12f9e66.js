(this.webpackJsonp=this.webpackJsonp||[]).push([[41],{"+t8S":function(e,t,n){e.exports={wrapper:"wrapper--lMZ2U",flex1:"flex1--2TINM",h_flex:"h_flex--25-V9",v_center:"v_center--1_C-p",v_flex:"v_flex--1LTkR",vh_center:"vh_center--1Y97O",h_start:"h_start--17gSr",h_end:"h_end--1KnH6",h_center:"h_center--uzQ1B",clickable:"clickable--2a1qz",confirm:"confirm--3jtl9",dialog:"dialog--3n0Ru",device_detect_dialog:"device_detect_dialog--I9WlU",content:"content--QKutg",showDialog:"showDialog--1Qz1J","wrapper--appear--active":"wrapper--appear--active--10rB7","wrapper--appear":"wrapper--appear--3kYlE",mask:"mask--SL92a",material:"material--2HgaJ",showMask:"showMask--3NWf6",dialog_btn_close:"dialog_btn_close--3YRXR",title:"title--1N8dn",close_icon:"close_icon--1CTFz",detect_result:"detect_result--3CvAo",good_detect_list:"good_detect_list--1dptT","des-title":"des-title--xRZMZ","des-content":"des-content--1z78t",btns:"btns--1RsNF",btn_mid:"btn_mid--1dYd2","res-container":"res-container--21Har","res-row":"res-row--1zZLu","res-description":"res-description--10PD0",suggestion:"suggestion--GBgUm","res-icon-0":"res-icon-0--tQA_-","res-icon-1":"res-icon-1--2JYnl","res-icon-2":"res-icon-2--1FsSl"}},LQFl:function(e,t,n){"use strict";n.r(t),n.d(t,"DeviceDetectDialogComponent",(function(){return R}));var r,s=n("o0o1"),i=n.n(s),a=n("yXPU"),o=n.n(a),c=n("lwsE"),d=n.n(c),_=n("W8MJ"),l=n.n(_),u=n("a1gu"),p=n.n(u),g=n("Nsbk"),w=n.n(g),v=n("7W2i"),m=n.n(v),h=n("q1tI"),b=n("2OET"),f=n("/MKj"),k=n("ANjH"),y=n("WFO7"),O=n("JcTc"),E=n("CG87"),W=n("G72A"),x=n("WWDN");function N(){return D.apply(this,arguments)}function D(){return(D=o()(i.a.mark((function e(){var t,n,r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new Date).getTime(),r=new Image,s="https://kn-cdn.codemao.cn/application/detect/detect_new.jpg?".concat(n),e.abrupt("return",new Promise((function(e){t=setTimeout((function(){e(-1)}),16e3),r.onload=function(){var r=(new Date).getTime(),s=parseInt(String(1048576/(r-n)));clearTimeout(t),e(s)},r.onerror=function(){clearTimeout(t),e(0)},r.src=s})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){var e={stencil:!0,failIfMajorPerformanceCaveat:!0};try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement("canvas"),n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),r=!(!n||!n.getContextAttributes().stencil);if(n){var s=n.getExtension("WEBGL_lose_context");s&&s.loseContext()}return n=void 0,r}catch(e){return!1}}function C(){return Object(x.g)()?r.MAC:Object(x.l)()?r.XP:Object(x.k)()?r.WIN7_HIGHER:r.ELSE}function S(){return B.apply(this,arguments)}function B(){return(B=o()(i.a.mark((function e(){var t,n,r,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:return t=e.sent,n=M(),r=C(),s={type:Object(x.c)(),version:0},Object(x.e)()&&(s.version=Object(x.a)()),e.abrupt("return",{network:t,webgl:n,system:r,browser:s});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){var e=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]].map((function(e){return{name:e[0],rule:e[1]}})),t=navigator.userAgent,n=e.filter((function(e){return e.rule&&e.rule.test(t)}))[0],r={name:"",version:""};return n?(r.name=n.name,n&&(r.version=function(e){var t=navigator.userAgent;switch(e){case"Mac OS":var n=t.match(/\d*_\d*_\d*/);return n&&n[0]?n[0].replace(/_/g,"."):"";default:if(/Windows/.test(e)){var r=t.match(/x\d{2}/);return r?r[0]:""}return""}}(n.name),r.name=n.name),r):r}!function(e){e[e.XP=0]="XP",e[e.WIN7_HIGHER=1]="WIN7_HIGHER",e[e.MAC=2]="MAC",e[e.ELSE=3]="ELSE"}(r||(r={}));var A,j;n("+t8S");(function(e){e[e.CHECKING=0]="CHECKING",e[e.DONE=1]="DONE"})(A||(A={})),function(e){e[e.GOOD=0]="GOOD",e[e.WELL=1]="WELL",e[e.BAD=2]="BAD"}(j||(j={}));var L={unknown:{state:j.BAD,advice:"device_detect_dialog/no_speed_advice"},no_speed:{state:j.BAD,advice:"device_detect_dialog/no_speed_advice"},low_speed:{state:j.BAD,advice:"device_detect_dialog/low_speed_advice",link:{text:"device_detect_dialog/download",url:""},show_result:!0},middle_speed:{state:j.WELL,advice:"device_detect_dialog/middle_speed_advice",show_result:!0},fast_speed:{state:j.GOOD,advice:"device_detect_dialog/fast_speed_advice",show_result:!0}},I={other_browser:{state:j.BAD,link:{text:"device_detect_dialog/recommend_browser_des",url:""},prefix:"device_detect_dialog/recommend_browser_advice"},bad_browser:{state:j.BAD,link:{text:"device_detect_dialog/recommend_browser_des",url:""},prefix:"device_detect_dialog/recommend_browser_advice"},well_browser:{state:j.WELL,link:{text:"device_detect_dialog/recommend_browser_des",url:""},prefix:"device_detect_dialog/recommend_browser_advice"},good_browser:{state:j.GOOD,prefix:"device_detect_dialog/current_broswer",show_result:!0}},T={xp_system:{state:j.BAD,advice:"device_detect_dialog/xp_advice_advice"},win_support_system:{state:j.GOOD,show_result:!0},mac_system:{state:j.GOOD,show_result:!0},other_system:{state:j.WELL,show_result:!0}},H={support:{state:j.GOOD,advice:"device_detect_dialog/webgl_support_advice"},unsupport:{state:j.BAD,advice:"device_detect_dialog/webgl_unsupport_advice",link:{text:"device_detect_dialog/enable_webgl",url:"https://docs.codemao.cn/kitten/knowledge/ru-he-kai-qi-webgl.html"}}},P=function(e){function t(e){var n;return d()(this,t),(n=p()(this,w()(t).call(this,e))).get_intl_msg=function(e){return n.props.intl.formatMessage({id:e})},n.get_state_by_detector=function(e){var t=n.state;return{state:t["".concat(e,"_state")],result:t["".concat(e,"_result")],data:t["".concat(e,"_data")]}},n.state={step:A.CHECKING,network_state:j.GOOD,network_result:"",network_data:"",browser_state:j.GOOD,browser_result:"",browser_data:"",webgl_state:j.GOOD,webgl_result:"",webgl_data:"",system_state:j.GOOD,system_result:"",system_data:""},n}var s;return m()(t,e),l()(t,[{key:"componentDidMount",value:function(){this.device_detect().catch((function(e){return console.log(e)}))}},{key:"on_request_close",value:function(){this.props.close_dialog({dialog_type:"device_detect"})}},{key:"get_network_judge",value:function(e){return-1===e?"unknown":0===e?"no_speed":e>0&&e<500?"low_speed":e>500&&e<2048?"middle_speed":"fast_speed"}},{key:"get_webgl_judge",value:function(e){return e?"support":"unsupport"}},{key:"get_system_judge",value:function(e){return e===r.XP?"xp_system":e===r.WIN7_HIGHER?"win_support_system":e===r.MAC?"mac_system":"other_system"}},{key:"get_browser_judge",value:function(e){if(!e)return"other_browser";if("Chrome"===e.type){if(e.version>=58)return"good_browser";if(e.version>=49&&e.version<58)return"well_browser";if(e.version<49)return"bad_browser"}return"other_browser"}},{key:"get_browser_data",value:function(e){return e&&e.type&&e.version?"".concat(e.type," ").concat(e.version):""}},{key:"get_webgl_data",value:function(e){return e?this.props.intl.formatMessage({id:"device_detect_dialog/webgl_support"}):this.props.intl.formatMessage({id:"device_detect_dialog/webgl_unsupport"})}},{key:"get_network_data",value:function(e){return-1===e?this.props.intl.formatMessage({id:"device_detect_dialog/unknown"}):e>1024?"".concat(this.props.intl.formatMessage({id:"device_detect_dialog/current_network_speed"})," ").concat((e/1024).toFixed(1),"MB/s"):"".concat(this.props.intl.formatMessage({id:"device_detect_dialog/current_network_speed"})," ").concat(e,"KB/s")}},{key:"device_detect",value:(s=o()(i.a.mark((function e(){var t,n,r,s,a,o,c,d,_,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:t=e.sent,n=t.network,r=t.webgl,s=t.system,a=t.browser,o=this.get_network_judge(n),c=this.get_webgl_judge(r),d=this.get_system_judge(s),_=a?this.get_browser_judge(a):"",l=a?I[_].state:j.GOOD,this.setState({step:A.DONE,network_state:L[o].state,network_result:o,network_data:this.get_network_data(n),webgl_state:H[c].state,webgl_result:c,webgl_data:this.get_webgl_data(r),system_state:T[d].state,system_result:d,system_data:G().name+G().version,browser_state:l,browser_result:_,browser_data:this.get_browser_data(a)});case 10:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"recheck",value:function(){this.setState({step:A.CHECKING}),this.device_detect().catch((function(e){return console.log(e)}))}},{key:"render_detecting",value:function(){return h.createElement("div",{className:"th1-text-t7 content--QKutg"},h.createElement("img",{src:n("tYc+")}),h.createElement("span",null,this.get_intl_msg("device_detect_dialog/detect_start")),h.createElement("span",null,this.get_intl_msg("device_detect_dialog/detect_time")))}},{key:"render_content",value:function(){return this.state.step===A.CHECKING?this.render_detecting():this.render_detect_result()}},{key:"render_btns",value:function(){if(this.state.step===A.DONE)return h.createElement("div",{className:"btns--1RsNF"},h.createElement("div",{className:"th1-bg-0 th1-bg-hover-m1 th1-bg-active-m2 th1-text-10 th1-text-s1 btn_mid--1dYd2",onClick:this.recheck.bind(this),"data-report-click":"设置-重新检测"},this.get_intl_msg("device_detect_dialog/retry")))}},{key:"render_detect_result",value:function(){var e=this,t=[L,I,H,T];return h.createElement("div",{className:"res-container--21Har"},["network","browser","webgl","system"].map((function(n,r){var s=e.get_state_by_detector(n),i=s.state,a=s.result,o=s.data,c=t[r][a];return h.createElement("div",{key:r,className:"th1-text-t7 res-row--1zZLu"},h.createElement("span",null,h.createElement(O.a,{id:"#icon_result_".concat(i),size:30})),h.createElement("div",{className:"res-description--10PD0"},h.createElement("span",null,h.createElement(O.a,{id:"#icon_".concat(n),size:25})),h.createElement("div",{className:"th1-text-t7 des-title--xRZMZ"},e.props.intl.formatMessage({id:"device_detect_dialog/".concat(n)}))),h.createElement("div",{className:"suggestion--GBgUm"},c.prefix&&e.props.intl.formatMessage({id:"".concat(c.prefix)}),c.show_result&&o,c.advice&&e.props.intl.formatMessage({id:"".concat(c.advice)}),c.link&&h.createElement("a",{href:"javascript:void(0);",onClick:e.get_link_url.bind(e,c.link.url)},e.props.intl.formatMessage({id:c.link.text}))))})))}},{key:"get_link_url",value:function(e){e?window.open(e):window.open("".concat(Object(y.a)().community,"/download"))}},{key:"render",value:function(){return h.createElement(E.a,{type:"device_detect",on_request_close:this.on_request_close.bind(this),close_btn:!1},h.createElement("div",{className:"device_detect_dialog--I9WlU"},h.createElement("span",{className:"th1-text-t7 title--1N8dn"},this.get_intl_msg("device_detect_dialog/title")),h.createElement("div",{className:"close_icon--1CTFz",onClick:this.on_request_close.bind(this)},h.createElement(O.a,{id:"#iconicon-delete",size:20,class_name:"th1-text-t5"})),this.render_content(),this.render_btns()))}}]),t}(h.Component);var R=Object(b.b)(Object(f.connect)(void 0,(function(e){return Object(k.bindActionCreators)({close_dialog:W.c},e)}))(P))},"tYc+":function(e,t){e.exports="../build/asset/device_detect_loading_afaaa.gif"}}]);
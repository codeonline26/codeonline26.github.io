(this.webpackJsonp=this.webpackJsonp||[]).push([[47],{bpvM:function(e,t,n){e.exports={container:"container--RcKl5",header:"header--1dC2F",content:"content--3V24u",label_text:"label_text--wKLDs",properties_container:"properties_container--AZgVu",label:"label--2_QUk",error_info:"error_info--LmGKR",properties_input:"properties_input--2XqFB",range:"range--tXiL9",public:"public--2Fvw6",local:"local--2CW2u",icon:"icon--1IMiz",range_label:"range_label--1koFj",selected:"selected--1clFr",footer:"footer--2RGzm",footer_tips:"footer_tips--3SH2O"}},eW9d:function(e,t,n){"use strict";n.r(t),n.d(t,"AddCloudVariableDialogComponent",(function(){return P}));var r=n("o0o1"),a=n.n(r),i=n("yXPU"),o=n.n(i),l=n("lwsE"),c=n.n(l),s=n("W8MJ"),_=n.n(s),d=n("a1gu"),u=n.n(d),p=n("Nsbk"),m=n.n(p),b=n("PJYZ"),g=n.n(b),v=n("7W2i"),f=n.n(v),h=n("kNvX"),E=n.n(h),y=n("q1tI"),k=n("ANjH"),N=n("/MKj"),w=n("2OET"),C=n("G72A"),x=n("CG87"),L=n("Gzrk"),F=n("iE9P"),S=n("5nG9"),j=n("JrHu"),I=n("i3Cl"),M=n("LG/P"),O=(n("bpvM"),{"./style.scss":{container:"container--RcKl5",header:"header--1dC2F",content:"content--3V24u",label_text:"label_text--wKLDs",properties_container:"properties_container--AZgVu",label:"label--2_QUk",error_info:"error_info--LmGKR",properties_input:"properties_input--2XqFB",range:"range--tXiL9",public:"public--2Fvw6",local:"local--2CW2u",icon:"icon--1IMiz",range_label:"range_label--1koFj",selected:"selected--1clFr",footer:"footer--2RGzm",footer_tips:"footer_tips--3SH2O"}});var R=function(e){function t(e){var n;return c()(this,t),(n=u()(this,m()(t).call(this,e))).name_input_el=void 0,n.get_input_el=function(e){n.name_input_el=e},n.get_intl_msg=function(e){return n.props.intl.formatMessage({id:e})},n.on_request_close=function(){n.props.close_dialog({dialog_type:"add_cloud_variable"})},n.on_confirm_btn=function(){var e=o()(a.a.mark((function e(t){var r,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(j.a)()){e.next=3;break}return Object(M.c)(M.a.SHOW_PREVENT_SAVE_TOAST),e.abrupt("return");case 3:if(!0!==t||!n.state.disable_confirm){e.next=5;break}return e.abrupt("return");case 5:if(e.prev=5,n.setState({disable_confirm:!0}),Object(I.e)(n.on_confirm_btn.bind(g()(n)),(function(){n.setState({disable_confirm:!1})}))){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,Object(I.g)(n.state.editing_name,n.state.cv_type);case 12:r=e.sent,i=n.props.cloud_variable_setting||{},(o=i.on_success)&&r&&o(r.id,r.type),n.on_request_close(),e.next=23;break;case 18:e.prev=18,e.t0=e.catch(5),n.setState({disable_confirm:!1}),e.t0.error_code===I.c&&e.t0.type===I.b.PUBLIC_LIST&&n.on_request_close();case 23:case"end":return e.stop()}}),e,null,[[5,18]])})));return function(t){return e.apply(this,arguments)}}(),n.is_list=function(){return!(!n.props.cloud_variable_setting||n.props.cloud_variable_setting.type!==I.b.PUBLIC_LIST)},n.render_header=function(){var e=n.get_intl_msg(n.is_list()?"cloud_variable/add/list":"cloud_variable/add/variable");return y.createElement("div",{className:"header--1dC2F"},e)},n.handle_name_input_change=function(e){var t=Object(F.variable_name_validator)(e.target.value,!n.is_list(),!0,"");n.setState({editing_name:e.target.value,name_error:t})},n.render_error_msg=function(){var e=n.state.name_error;return""!==e&&y.createElement("div",{className:"error_info--LmGKR"},n.get_intl_msg(F.error_map[e]))},n.render_name=function(){return y.createElement("div",{className:"properties_container--AZgVu"},y.createElement("div",{className:"label--2_QUk"},n.get_intl_msg("dialog/add_variable_dialog/name")),y.createElement("div",{className:"properties_input--2XqFB"},y.createElement(L.d,{autofocus:!0,margin:"6px",width:"100%",input_style:{paddingRight:"10px",borderColor:n.state.name_error?"#ff472e":void 0},placeholder:n.is_list()?"cloud_variable/add_list/placeholder":"cloud_variable/add_variable/placeholder",value:n.state.editing_name,on_change:n.handle_name_input_change,get_input_el:n.get_input_el,classname:"th1-bg-8 ".concat(""===n.state.name_error?"th1-border-impt-focus-0 th1-border-impt-hover-0":""),data_report_on_blur:"".concat(n.is_list()?"云列表":"云变量","-名称")}),n.render_error_msg()))},n.render_range=function(){var e=n.state.cv_type===I.b.PUBLIC;return y.createElement("div",{className:"properties_container--AZgVu"},y.createElement("div",{className:"label--2_QUk"},n.get_intl_msg("dialog/add_variable_dialog/property")),y.createElement("div",{className:"properties_input--2XqFB"},y.createElement("div",{className:"range--tXiL9"},y.createElement("div",{onClick:function(){return n.setState({cv_type:I.b.PUBLIC})},"data-report-click":"云变量-公有云",className:(e||"th1-bg-9"?(e?"th1-bg-8 th1-border-impt-0":"th1-bg-9")+" ":"")+E()("public ".concat(e?"selected":""),O,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},y.createElement("div",{className:"icon--1IMiz"},y.createElement(L.c,{id:"#iconicon_gongyouyun",size:23,class_name:"th1-text-0 th1-text-s2"})),y.createElement("div",{className:"th1-text-t7 range_label--1koFj"},"".concat(n.get_intl_msg("cloud_variable/new_public_variable")))),y.createElement("div",{onClick:function(){return n.setState({cv_type:I.b.PRIVATE})},"data-report-click":"云变量-私有云",className:(e||"th1-bg-8 th1-border-impt-0"?(e?"th1-bg-9":"th1-bg-8 th1-border-impt-0")+" ":"")+E()("local ".concat(e?"":"selected"),O,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},y.createElement("div",{className:"icon--1IMiz"},y.createElement(L.c,{id:"#iconicon_siyouyunbianliang",size:23,class_name:"th1-text-0 th1-text-s2"})),y.createElement("div",{className:"th1-text-t7 range_label--1koFj"},"".concat(n.get_intl_msg("cloud_variable/new_private_variable")))))))},n.render_content=function(){return y.createElement("div",{className:"content--3V24u"},n.render_name(),!n.is_list()&&n.render_range())},n.render_footer=function(){return y.createElement(y.Fragment,null,y.createElement("div",{className:"footer--2RGzm"},y.createElement(L.a,{type:"primary-outline",width:120,height:36,on_click:n.on_request_close,data_report:"".concat(n.is_list()?"云列表":"云变量","-取消创建")},n.get_intl_msg("cloud_variable/cancel")),y.createElement(L.a,{width:120,height:36,type:"primary",disable:!n.should_add_variable(),data_report:"".concat(n.is_list()?"云列表":"云变量","-确定创建"),on_click:n.on_confirm_btn.bind(g()(n),!0)},n.state.disable_confirm?y.createElement(L.f,{size:16,theme_color:"10"}):n.get_intl_msg("cloud_variable/confirm")),y.createElement("div",null)),y.createElement("div",{className:"footer_tips--3SH2O"},n.render_footer_msg()))},n.render_footer_msg=function(){return n.is_list()?n.props.intl.formatMessage({id:"cloud_variable/list_add_tip"},{num:Object(I.i)()}):n.get_intl_msg("cloud_variable/var_add_tip")},n.should_add_variable=function(){return""!==n.state.editing_name&&""===n.state.name_error},n.handle_enter_down=function(e){n.should_add_variable()&&!n.state.disable_confirm&&13===e.keyCode&&n.on_confirm_btn(!0)},n.state={editing_name:"",cv_type:e.cloud_variable_setting?e.cloud_variable_setting.type:I.b.PUBLIC,name_error:""},n}return f()(t,e),_()(t,[{key:"componentDidMount",value:function(){this.name_input_el&&(this.name_input_el.focus(),this.name_input_el.addEventListener("keydown",(function(e){e.stopPropagation(),13===e.keyCode&&e.target.blur()}))),document.addEventListener("keydown",this.handle_enter_down)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handle_enter_down),this.props.set_dialog_props({cloud_variable_setting:void 0})}},{key:"render",value:function(){return y.createElement(x.a,{type:"add_cloud_variable",on_request_close:this.on_request_close.bind(this),close_btn:!0},y.createElement("div",{className:"container--RcKl5"},this.render_header(),this.render_content(),this.render_footer()))}}]),t}(y.Component);var P=Object(w.b)(Object(N.connect)((function(e){return{cloud_variable_setting:e.dialog_state.setting.cloud_variable_setting}}),(function(e){return Object(k.bindActionCreators)({close_dialog:C.c,set_dialog_props:C.f,show_toast:S.d},e)}))(R))}}]);
(this.webpackJsonp=this.webpackJsonp||[]).push([[26],{"0ZF1":function(e,t,i){e.exports={"dialog-title-wrap":"dialog-title-wrap--3CrUN","warning-icon":"warning-icon--2Ang4","dialog-title-words":"dialog-title-words--bkSYM","btn-group":"btn-group--2Z6Tp","confirm-btn":"confirm-btn--2qxNG","cancel-btn":"cancel-btn--3JhZe",edit_group_dialog:"edit_group_dialog--2S92a",showDialog:"showDialog--2M9ZK",edit_input:"edit_input--2zMhr",delete_text:"delete_text--1Pl9A",delete_text_centered:"delete_text_centered--1B-Dc"}},FwdS:function(e,t,i){e.exports={"dialog-title-wrap":"dialog-title-wrap--26ham","warning-icon":"warning-icon--1cEYy","dialog-title-words":"dialog-title-words--2nrP6","confirm-btn":"confirm-btn--3k3RC","btn-group":"btn-group--2yi8D","cancel-btn":"cancel-btn--2U1BU","move-to-group":"move-to-group--3Aoi3",move_group_dialog:"move_group_dialog--1Q75y",showDialog:"showDialog--3l2UV","title-wrap":"title-wrap--3zXpP","group-icon":"group-icon--3Gcx5",group_item:"group_item--o7HLh",group_item_active:"group_item_active--2CU-h","group-dropdown-wrap":"group-dropdown-wrap--3QY35","drop-down-icon":"drop-down-icon--20Cnl","error-notice":"error-notice--2T2kU","group-name-wrap":"group-name-wrap--2z-5V","input-group-name":"input-group-name--3VCOX",input_group:"input_group--249J0","edit-group-name":"edit-group-name--29UqS",error_notice:"error_notice--1JmPZ",latest_icon:"latest_icon--3GWyf",selected_icon:"selected_icon--2OydH",close_btn:"close_btn--2jinc"}},P7i2:function(e,t,i){e.exports={select_materials:"select_materials--2-U2O",material_wrap:"material_wrap--3xG5g",group_sidebar:"group_sidebar--1e-7e",group_wrap:"group_wrap--1A7KM",wrapper:"wrapper--1cmmM",flex1:"flex1--21z1H",h_flex:"h_flex--2oZDr",v_center:"v_center--lx-dz",v_flex:"v_flex--K5vHu",vh_center:"vh_center--1rVUT",h_start:"h_start--1SxBl",h_end:"h_end--QHLGV",h_center:"h_center--2l9-F",clickable:"clickable--IyM4x",confirm:"confirm--TW1Tx",dialog:"dialog--3ggv_",backpack_dialog:"backpack_dialog--320do",content:"content--28vV-",showDialog:"showDialog--1ikTq","wrapper--appear--active":"wrapper--appear--active--16bE8","wrapper--appear":"wrapper--appear--14tqQ",mask:"mask--1gudl",material:"material--2TN0W",showMask:"showMask--3b_8_",dialog_btn_close:"dialog_btn_close--ZFVGa",header:"header--znx3-",header_team_bp:"header_team_bp--1ywrU",header_my_bp:"header_my_bp--aWhlx",group_item:"group_item--3lW8O",group_icn:"group_icn--5xumt",icon_add:"icon_add--1_QGF",active:"active--UixD5",team_bp_icn:"team_bp_icn--25ynu",my_bp_icn:"my_bp_icn--3rNEo",dialog_content:"dialog_content--2TMU8",header_logo:"header_logo--1D_8g",close_btn:"close_btn--mYwMU",close_btn_icon:"close_btn_icon--1FxM9",group_sidebar_title:"group_sidebar_title--2r4uR",group_info:"group_info--34pvH",group_name:"group_name--XEiWc",team:"team--2F_Lt",material_item:"material_item--vHjP2",material_item_footer:"material_item_footer--3yIAh",loader:"loader--OISdy",spin:"spin--WEVzC",showItem:"showItem--23eth",delete_btn:"delete_btn--1dfm1",hide:"hide--1ihuN",icn_wrap:"icn_wrap--2wqdR",option_icon:"option_icon--3mtAr",selected:"selected--1Ozci",selected_icon:"selected_icon--3F8dJ",icnShow:"icnShow--Qyump",material_item_img_wrap:"material_item_img_wrap--LqD18",material_item_img:"material_item_img--3CA7u",material_item_title:"material_item_title--1vIWz",select_list_wrap:"select_list_wrap--_cVJM",show:"show--28VDM",actions:"actions--U6Kfr","cancel-btn":"cancel-btn--3NwIJ","confirm-btn":"confirm-btn--1LnwJ",backpack_tooltip_mask:"backpack_tooltip_mask--Fud_S",tooltip:"tooltip--10Jla",material_no_content:"material_no_content--3YKBc",no_content_icon:"no_content_icon--3Pbug",english:"english--3ZYaz",chinese:"chinese--2Y6KM"}},"iy/Q":function(e,t,i){"use strict";i.r(t),i.d(t,"BackpackDialogComponent",(function(){return ae}));var a,o=i("MVZn"),n=i.n(o),r=i("lwsE"),s=i.n(r),_=i("W8MJ"),c=i.n(_),l=i("a1gu"),p=i.n(l),m=i("Nsbk"),d=i.n(m),u=i("7W2i"),h=i.n(u),g=i("1iNE"),b=i.n(g),k=i("3WF5"),v=i.n(k),f=i("BkRI"),E=i.n(f),w=i("wEy/"),y=i.n(w),M=i("MJIl"),N=i.n(M),A=i("J2m7"),x=i.n(A),R=i("kNvX"),D=i.n(R),T=i("q1tI"),O=i("2OET"),L=i("/MKj"),U=i("ANjH"),I=i("CG87"),S=i("Vbab"),C=i("5nG9"),G=i("+yNH"),P=i("kTTF"),z=i("G72A"),j=i("k4Da"),q=i.n(j),F=i("5FhS"),J=i("HIk1"),W=i("2pfL");!function(e){e[e.NONE=0]="NONE",e[e.ADD_GROUP=1]="ADD_GROUP",e[e.RENAME_GROUP=2]="RENAME_GROUP",e[e.RENAME_MATERIAL=3]="RENAME_MATERIAL",e[e.DELETE_GROUP=4]="DELETE_GROUP",e[e.DELETE_MATERIAL=5]="DELETE_MATERIAL",e[e.DELETE_TEAM_MATERIAL=6]="DELETE_TEAM_MATERIAL"}(a||(a={}));var H=i("ofrH"),V=i("Jzgm");i("0ZF1");var K=function(e){function t(e){var i;return s()(this,t),(i=p()(this,d()(t).call(this,e))).is_modified=!1,i.name_input=void 0,i.state={success:void 0,input_text:""},i}return h()(t,e),c()(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({input_text:this.get_default_input_val()},(function(){e.name_input&&e.name_input.focus()}))}},{key:"on_request_close",value:function(){this.props.close_sub_dialog()}},{key:"get_default_input_val",value:function(){switch(this.props.type){case a.RENAME_GROUP:case a.RENAME_MATERIAL:return this.props.default_input_value.slice(0,20);default:return""}}},{key:"handle_input",value:function(e){this.setState({input_text:e.target.value})}},{key:"get_title_str",value:function(){switch(this.props.type){case a.ADD_GROUP:return"backpack/add_group";case a.RENAME_GROUP:return"backpack/edit_group_name";case a.RENAME_MATERIAL:return"backpack/edit_material_name";case a.DELETE_GROUP:case a.DELETE_MATERIAL:case a.DELETE_TEAM_MATERIAL:return"backpack/delete_confirm";default:return""}}},{key:"get_legal_name",value:function(e,t){var i=e;if(!i.trim())throw Error("empty");if(!(i=i.replace(/([^a-z0-9\u4e00-\u9fa5()\-_ ]+)/gi,"").trim()))throw Error("illegal");if(this.is_modified=i!==e,t)for(;t.indexOf(i)>=0;)i=Object(W.f)(i,"-");return i}},{key:"get_group_names",value:function(e){var t=q()(this.props.groups,(function(t){return t.id!==e}));return v()(t,(function(e){return e.name}))}},{key:"on_right_btn_click",value:function(){var e=this.props.id,t="";try{switch(this.props.type){case a.ADD_GROUP:Object(V.c)("分组","主动创建"),t=this.get_legal_name(this.state.input_text,this.get_group_names(e)),this.props.action_add_group({name:t,is_modified:this.is_modified});break;case a.RENAME_GROUP:Object(V.c)("分组","重命名分组"),t=this.get_legal_name(this.state.input_text,this.get_group_names(e)),this.props.action_rename_group({group_id:e,name:t,is_modified:this.is_modified});break;case a.RENAME_MATERIAL:Object(V.c)("素材","重命名素材"),t=this.get_legal_name(this.state.input_text),this.props.action_rename_material({material_id:this.props.id,name:t,is_modified:this.is_modified});break;case a.DELETE_GROUP:Object(V.c)("分组","删除分组"),this.props.action_delete_group({group_id:e});break;case a.DELETE_MATERIAL:Object(V.c)("素材","删除素材"),this.props.action_delete_material({material_id:e});break;case a.DELETE_TEAM_MATERIAL:Object(V.c)("素材","删除素材"),this.props.action_delete_team_material({material_id:e})}this.props.close_sub_dialog()}catch(e){var i="";switch(e.message){case"illegal":i="backpack/notice/illegal_input";break;case"empty":i="backpack/move_to_group/empty_group_name";break;default:i="bad_network_notice"}this.props.show_toast({content:i,type:"error"})}}},{key:"render_main_content",value:function(){switch(this.props.type){case a.ADD_GROUP:case a.RENAME_GROUP:case a.RENAME_MATERIAL:var e=this.props.type===a.RENAME_MATERIAL?"":this.props.intl.formatMessage({id:"backpack/default_group_name"});return T.createElement("div",{className:"edit_input--2zMhr"},T.createElement(F.a,{autofocus:!0,inputStyle:{width:"270px",height:"38px"},maxLength:20,placeholder:e,value:this.state.input_text,onChange:this.handle_input.bind(this)}));case a.DELETE_GROUP:return T.createElement("div",{className:"delete_text--1Pl9A"},this.props.intl.formatMessage({id:"backpack/delete_group_content"}));case a.DELETE_MATERIAL:case a.DELETE_TEAM_MATERIAL:return T.createElement("div",{className:"delete_text_centered--1B-Dc"},this.props.intl.formatMessage({id:"backpack/delete_material_content"}));default:return""}}},{key:"render",value:function(){return T.createElement(I.a,{type:"__none__",on_request_close:this.on_request_close.bind(this),close_btn:!0},T.createElement("div",{className:"edit_group_dialog--2S92a"},T.createElement("div",{className:"dialog-title-wrap--3CrUN"},T.createElement("div",{className:"warning-icon--2Ang4"}),T.createElement("div",{className:"dialog-title-words--bkSYM"},this.props.intl.formatMessage({id:this.get_title_str()}))),this.render_main_content(),T.createElement("div",{className:"btn-group--2Z6Tp"},T.createElement(J.a,{type:"secondary",width:112,height:36,onClick:this.on_request_close.bind(this)},this.props.intl.formatMessage({id:"backpack/cancel"})),T.createElement(J.a,{type:"primary",width:112,height:36,margin:"0 0 0 20px",onClick:this.on_right_btn_click.bind(this)},this.props.intl.formatMessage({id:"backpack/confirm"})))))}}]),t}(T.Component);var Y=Object(O.b)(Object(L.connect)((function(e){return{groups:e.backpack_state.groups}}),(function(e){return Object(U.bindActionCreators)({action_add_group:H.u,action_delete_group:H.x,action_delete_material:H.y,action_rename_group:H.C,action_rename_material:H.D,action_delete_team_material:H.z,show_toast:C.d},e)}))(K)),Z=i("T9Sj"),Q=i("xweI"),B=i.n(Q),X=(i("FwdS"),{"./style.scss":{"dialog-title-wrap":"dialog-title-wrap--26ham","warning-icon":"warning-icon--1cEYy","dialog-title-words":"dialog-title-words--2nrP6","btn-group":"btn-group--2yi8D","cancel-btn":"cancel-btn--2U1BU","confirm-btn":"confirm-btn--3k3RC",move_group_dialog:"move_group_dialog--1Q75y",showDialog:"showDialog--3l2UV","title-wrap":"title-wrap--3zXpP","move-to-group":"move-to-group--3Aoi3","group-icon":"group-icon--3Gcx5",group_item:"group_item--o7HLh",group_item_active:"group_item_active--2CU-h","group-dropdown-wrap":"group-dropdown-wrap--3QY35","drop-down-icon":"drop-down-icon--20Cnl","error-notice":"error-notice--2T2kU","group-name-wrap":"group-name-wrap--2z-5V","input-group-name":"input-group-name--3VCOX",input_group:"input_group--249J0","edit-group-name":"edit-group-name--29UqS",error_notice:"error_notice--1JmPZ",latest_icon:"latest_icon--3GWyf",selected_icon:"selected_icon--2OydH",close_btn:"close_btn--2jinc"}});var $=function(e){function t(e){var i;return s()(this,t),(i=p()(this,d()(t).call(this,e))).input_text="",i.update_group=void 0,i.is_modified=!1,i.state={success:void 0,show_drop_down:!1,selected_group:void 0,groups:[]},i}return h()(t,e),c()(t,[{key:"UNSAFE_componentWillMount",value:function(){this.props.action_fetch_groups(),this.update_group=!0}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(this.update_group&&this.props.groups!==e.groups){var t=B()(e.groups,(function(e){return-e.content_updated_at}));this.setState(n()({},this.state,{groups:t,selected_group:t[0]}))}}},{key:"on_request_close",value:function(){this.props.close_sub_dialog()}},{key:"get_legal_name",value:function(e,t){var i=e;if(!i.trim())throw Error("empty");if(!(i=i.replace(/([^a-z0-9\u4e00-\u9fa5()\-_ ]+)/gi,"").trim()))throw Error("illegal");for(this.is_modified=i!==e;t.indexOf(i)>=0;)i=Object(W.f)(i,"-");return i}},{key:"handle_input_keydown",value:function(e){try{var t=this.input_text,i=v()(this.props.groups,(function(e){return e.name}));13===e.keyCode&&(Object(V.c)("分组","选择分组时创建"),t=this.get_legal_name(t,i),this.props.action_add_group({name:t,is_modified:this.is_modified}))}catch(e){var a="";switch(e.message){case"illegal":a="backpack/notice/illegal_input";break;case"empty":a="backpack/move_to_group/empty_group_name";break;default:a="bad_network_notice"}this.props.show_toast({content:a,type:"error"})}}},{key:"on_group_item_click",value:function(e){Object(V.c)("分组","选择分组"),this.setState(n()({},this.state,{selected_group:e}))}},{key:"on_confirm_btn_click",value:function(){Object(V.c)("素材","移动"),this.state.selected_group&&this.props.action_set_material_group({group:this.state.selected_group,material_id:this.props.material_id,cb:this.on_request_close.bind(this)})}},{key:"handle_input",value:function(e){this.state.error_notice&&this.setState({error_notice:void 0}),this.input_text=e.target.value}},{key:"render",value:function(){var e=this;return T.createElement(I.a,{type:"__none__",on_request_close:this.on_request_close.bind(this),close_btn:!1},T.createElement("div",{className:"move_group_dialog--1Q75y"},T.createElement("div",{className:"title-wrap--3zXpP"},T.createElement("div",{className:"group-icon--3Gcx5"}),T.createElement("div",{className:"dialog-title-words--2nrP6"},this.props.intl.formatMessage({id:"backpack/move_to_group"}))),T.createElement("div",{className:"move-to-group--3Aoi3"},v()(this.state.groups,(function(t,i){var a=!!e.state.selected_group&&e.state.selected_group.id===t.id;return T.createElement("div",{onClick:e.on_group_item_click.bind(e,E()(t)),className:D()("".concat(a?"group_item_active":"group_item"),X,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},0===i?T.createElement("div",{className:"latest_icon--3GWyf"}):null,t.name,a&&T.createElement("span",{className:"selected_icon--2OydH"}))}))),T.createElement("div",{className:"input_group--249J0"},T.createElement("input",{type:"text",maxLength:20,placeholder:this.props.intl.formatMessage({id:"backpack/move_to_group/create_group"}),className:"edit-group-name--29UqS",onChange:this.handle_input.bind(this),onKeyDown:this.handle_input_keydown.bind(this)}),T.createElement("div",{className:"error_notice--1JmPZ"},this.state.error_notice)),T.createElement("div",{className:"confirm-btn--3k3RC",onClick:this.on_confirm_btn_click.bind(this)},this.props.intl.formatMessage({id:"backpack/confirm"})),T.createElement("div",{className:"close_btn--2jinc",onClick:this.on_request_close.bind(this)})))}}]),t}(T.Component);var ee=Object(O.b)(Object(L.connect)((function(e){return{groups:e.backpack_state.groups,materials:e.backpack_state.materials}}),(function(e){return Object(U.bindActionCreators)({action_set_material_group:H.H,action_add_group:H.u,action_fetch_groups:H.A,show_toast:C.d},e)}))($)),te=(i("P7i2"),{"./style.scss":{flex1:"flex1--21z1H",h_flex:"h_flex--2oZDr",v_center:"v_center--lx-dz",v_flex:"v_flex--K5vHu",vh_center:"vh_center--1rVUT",h_start:"h_start--1SxBl",h_end:"h_end--QHLGV",h_center:"h_center--2l9-F",clickable:"clickable--IyM4x",wrapper:"wrapper--1cmmM",confirm:"confirm--TW1Tx",dialog:"dialog--3ggv_",content:"content--28vV-",showDialog:"showDialog--1ikTq","wrapper--appear--active":"wrapper--appear--active--16bE8","wrapper--appear":"wrapper--appear--14tqQ",mask:"mask--1gudl",material:"material--2TN0W",showMask:"showMask--3b_8_",dialog_btn_close:"dialog_btn_close--ZFVGa",backpack_dialog:"backpack_dialog--320do",dialog_content:"dialog_content--2TMU8",header:"header--znx3-",header_logo:"header_logo--1D_8g",header_my_bp:"header_my_bp--aWhlx",my_bp_icn:"my_bp_icn--3rNEo",header_team_bp:"header_team_bp--1ywrU",team_bp_icn:"team_bp_icn--25ynu",active:"active--UixD5",close_btn:"close_btn--mYwMU",close_btn_icon:"close_btn_icon--1FxM9",group_sidebar:"group_sidebar--1e-7e",group_sidebar_title:"group_sidebar_title--2r4uR",icon_add:"icon_add--1_QGF",group_wrap:"group_wrap--1A7KM",group_item:"group_item--3lW8O",group_info:"group_info--34pvH",group_icn:"group_icn--5xumt",group_name:"group_name--XEiWc",team:"team--2F_Lt",material_wrap:"material_wrap--3xG5g",loader:"loader--OISdy",spin:"spin--WEVzC",material_item_footer:"material_item_footer--3yIAh",showItem:"showItem--23eth",delete_btn:"delete_btn--1dfm1",hide:"hide--1ihuN",material_item:"material_item--vHjP2",icn_wrap:"icn_wrap--2wqdR",option_icon:"option_icon--3mtAr",selected:"selected--1Ozci",selected_icon:"selected_icon--3F8dJ",icnShow:"icnShow--Qyump",material_item_img_wrap:"material_item_img_wrap--LqD18",material_item_img:"material_item_img--3CA7u",material_item_title:"material_item_title--1vIWz",select_list_wrap:"select_list_wrap--_cVJM",show:"show--28VDM",select_materials:"select_materials--2-U2O",actions:"actions--U6Kfr","confirm-btn":"confirm-btn--1LnwJ","cancel-btn":"cancel-btn--3NwIJ",backpack_tooltip_mask:"backpack_tooltip_mask--Fud_S",tooltip:"tooltip--10Jla",material_no_content:"material_no_content--3YKBc",no_content_icon:"no_content_icon--3Pbug",english:"english--3ZYaz",chinese:"chinese--2Y6KM"}});var ie=function(e){function t(e){var i;return s()(this,t),(i=p()(this,d()(t).call(this,e))).allow_lazy_fetch=!0,i.material_wrap=void 0,i.current_group_index=0,i.get_intl_msg=function(e){return i.props.intl.formatMessage({id:e})},i.state={is_my_bp:!0,tooltip:{id:"",name:"",type:"",position:{x:0,y:0}},move_group_dialog:!1,confirm_dialog:a.NONE,del_material_id:""},i}return h()(t,e),c()(t,[{key:"componentDidMount",value:function(){this.props.action_fetch_groups()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.groups.length!==e.groups.length&&this.handle_group_change(this.props.groups,e.groups),this.state.is_my_bp&&this.props.load_status!==e.load_status&&(this.allow_lazy_fetch=e.load_status===Z.a.LOADED,e.load_status===Z.a.LOADED&&this.on_material_wrap_scroll()),this.props.selected_group_id!==e.selected_group_id&&(this.props.action_set_fetch_current_page(!1),this.props.action_set_materials([]),this.props.action_set_page(1),this.state.is_my_bp&&this.props.action_fetch_materials({group_id:e.selected_group_id}))}},{key:"componentWillUnmount",value:function(){this.props.action_clear_backpack_state()}},{key:"on_request_close",value:function(){this.props.close_dialog({dialog_type:"backpack"})}},{key:"handle_group_change",value:function(e,t){var i=this;if(t.length)if(e.length){if(!x()(t,(function(e){return e.id===i.props.selected_group_id}))){this.current_group_index=Math.min(this.current_group_index,t.length-1);var a=t[this.current_group_index];this.on_group_item_click(a.id)}}else this.on_group_item_click(t[0].id);else this.props.action_clear_backpack_state()}},{key:"on_group_item_click",value:function(e,t){this.props.selected_group_id!==e&&(t&&(this.current_group_index=t),this.props.action_set_selected_group_id(e))}},{key:"on_add_group_click",value:function(){this.setState(n()({},this.state,{confirm_dialog:a.ADD_GROUP}))}},{key:"on_material_wrap_scroll",value:function(){if(this.state.is_my_bp&&(this.state.tooltip.type&&this.hide_tooltip(),this.allow_lazy_fetch&&""!==this.props.selected_group_id)){var e=this.material_wrap;if(Math.abs(e.clientHeight+e.scrollTop-e.scrollHeight)<V.a){this.allow_lazy_fetch=!1;var t=this.props.selected_group_id;this.props.action_fetch_materials({group_id:t})}}}},{key:"show_tooltip",value:function(e,t,i,a){a.stopPropagation();var o=a.target.getBoundingClientRect(),r=o.left,s=o.top;window.addEventListener("click",this.hide_tooltip.bind(this)),this.setState(n()({},this.state,{tooltip:{id:t,name:i,type:e,position:{x:r+V.d,y:s+V.e}}}))}},{key:"on_material_item_click",value:function(e){var t=E()(this.props.selected_materials);N()(t,{id:e.id})?y()(t,(function(t){return e.id===t.id})):t.push(e),this.props.action_set_selected_materials(t)}},{key:"on_footer_material_click",value:function(e){var t=this;this.setState(n()({},this.state,{del_material_id:e.id})),setTimeout((function(){t.on_material_item_click(e),t.setState(n()({},t.state,{del_material_id:""}))}),100)}},{key:"on_confirm_btn_click",value:function(){var e=v()(this.props.selected_materials,(function(e){return{url:e.resource_url,name:e.name}}));this.props.selected_materials.length>G.b?this.props.show_toast({content:"backpack/notice/bcmp_limit",type:"error"}):(this.props.action_fetch_bcmps_by_urls({urls:e}),this.props.close_dialog({dialog_type:"backpack"}))}},{key:"on_cancel_btn_click",value:function(){this.props.action_clear_selected_materials()}},{key:"hide_tooltip",value:function(){this.setState({tooltip:{id:this.state.tooltip.id,name:this.state.tooltip.name,type:"",position:{x:0,y:0}}})}},{key:"close_sub_dialog",value:function(){this.setState(n()({},this.state,{move_group_dialog:!1,confirm_dialog:a.NONE}))}},{key:"on_move_group_btn_click",value:function(){this.setState({move_group_dialog:!0}),this.hide_tooltip()}},{key:"on_rename_click",value:function(){this.setState(n()({},this.state,{confirm_dialog:"material"===this.state.tooltip.type?a.RENAME_MATERIAL:a.RENAME_GROUP})),this.hide_tooltip()}},{key:"on_delete_click",value:function(){var e;e="group"===this.state.tooltip.type?a.DELETE_GROUP:this.state.is_my_bp?a.DELETE_MATERIAL:a.DELETE_TEAM_MATERIAL,this.setState(n()({},this.state,{confirm_dialog:e})),this.hide_tooltip()}},{key:"render_tooltip",value:function(){return T.createElement("div",{className:"tooltip--10Jla",style:this.state.tooltip&&{left:this.state.tooltip.position.x,top:this.state.tooltip.position.y}},this.state.is_my_bp&&"material"===this.state.tooltip.type&&T.createElement("div",{onClick:this.on_move_group_btn_click.bind(this)},this.props.intl.formatMessage({id:"backpack/move_to_group"})),this.state.is_my_bp&&T.createElement("div",{onClick:this.on_rename_click.bind(this)},this.props.intl.formatMessage({id:"backpack/rename"})),T.createElement("div",{onClick:this.on_delete_click.bind(this)},this.props.intl.formatMessage({id:"backpack/delete"})))}},{key:"render_no_materials",value:function(){return T.createElement("div",{className:"material_no_content--3YKBc"},T.createElement("div",{className:D()("no_content_icon ".concat("en"===Object(S.e)()?"english":"chinese"),te,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})}),T.createElement("p",null,this.get_intl_msg("backpack/no_materials")),T.createElement("p",null,this.get_intl_msg("backpack/how_to_add_materials")))}},{key:"render_materials",value:function(){var e=this;return T.createElement("div",{onScroll:this.on_material_wrap_scroll.bind(this),ref:function(t){t&&(e.material_wrap=t)},className:D()("material_wrap ".concat(this.state.is_my_bp?"":"team"),te,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},v()(this.props.materials,(function(t,i){var a=t.id,o=t.name,n=t.preview_url,r=N()(e.props.selected_materials,{id:a});return T.createElement("div",{key:i,onClick:e.on_material_item_click.bind(e,t),className:D()("material_item ".concat(r?"selected":""),te,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},r?T.createElement("div",{className:"selected_icon--3F8dJ"}):T.createElement("div",{className:"option_icon--3mtAr",onClick:e.show_tooltip.bind(e,"material",a,o)}),T.createElement("div",{className:"material_item_img_wrap--LqD18"},T.createElement("img",{className:"material_item_img--3CA7u",src:n})),T.createElement("div",{className:"material_item_title--1vIWz"},o))})),0===this.props.materials.length?this.props.load_status===Z.a.LOADING?T.createElement("div",{className:"loader--OISdy"}):this.render_no_materials():null)}},{key:"render_selected_materials",value:function(){var e=this;return T.createElement("div",{className:D()("select_list_wrap ".concat(this.state.is_my_bp?"":"team"," ").concat(this.props.selected_materials.length?"show":""),te,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},T.createElement("div",{className:"select_materials--2-U2O"},v()(this.props.selected_materials,(function(t,i){var a=t.name,o=t.preview_url,n=t.id;return T.createElement("div",{key:i,className:D()("material_item_footer ".concat(e.state.del_material_id===n?"hide":""),te,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},T.createElement("div",{className:"material_item_img_wrap--LqD18"},T.createElement("img",{className:"material_item_img--3CA7u",src:o})),T.createElement("span",{className:"delete_btn--1dfm1",onClick:e.on_footer_material_click.bind(e,t)}),T.createElement("div",{className:"material_item_title--1vIWz"},a))}))),T.createElement("div",{className:"actions--U6Kfr"},T.createElement("div",{className:"cancel-btn--3NwIJ",onClick:this.on_cancel_btn_click.bind(this)},this.props.intl.formatMessage({id:"backpack/clear"})),T.createElement("div",{className:"confirm-btn--1LnwJ",onClick:this.on_confirm_btn_click.bind(this)},this.props.intl.formatMessage({id:"backpack/confirm_add_bcmp"}),"(",b()(this.props.selected_materials),")")))}},{key:"render_group",value:function(){var e=this;return T.createElement("div",{className:D()("group_sidebar ".concat(this.state.is_my_bp?"":"team"),te,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},T.createElement("div",{className:"group_sidebar_title--2r4uR"},this.props.intl.formatMessage({id:"backpack/my_materials"}),T.createElement("div",{className:"icon_add--1_QGF",onClick:this.on_add_group_click.bind(this)})),T.createElement("div",{className:"group_wrap--1A7KM"},v()(this.props.groups,(function(t,i){var a=t.name,o=t.id;return T.createElement("div",{key:i,onClick:e.on_group_item_click.bind(e,t.id,i),className:D()("group_item ".concat(e.props.selected_group_id===t.id?"active":""),te,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},T.createElement("span",{className:"group_icn--5xumt"}),T.createElement("span",{className:"group_name--XEiWc"},a),!t.is_default&&T.createElement("span",{className:"group_info--34pvH",onClick:e.show_tooltip.bind(e,"group",o,a)}))}))))}},{key:"render_header",value:function(){return T.createElement("div",{className:"header--znx3-"},T.createElement("div",{className:"header_logo--1D_8g"},this.get_intl_msg("backpack/title")),T.createElement("div",{className:"close_btn--mYwMU",onClick:this.on_request_close.bind(this)},T.createElement("div",{className:"close_btn_icon--1FxM9"})))}},{key:"render",value:function(){return T.createElement(I.a,{type:"backpack",on_request_close:this.on_request_close.bind(this),close_btn:!1},T.createElement("div",{className:"backpack_dialog--320do"},this.render_header(),T.createElement("div",{className:"dialog_content--2TMU8"},this.render_group(),this.render_materials(),this.render_selected_materials()),this.state.tooltip.type&&T.createElement("div",{className:"backpack_tooltip_mask--Fud_S",onClick:this.hide_tooltip.bind(this)}),this.state.tooltip.type&&this.render_tooltip(),this.state.move_group_dialog&&T.createElement(ee,{material_id:this.state.tooltip.id,close_sub_dialog:this.close_sub_dialog.bind(this)}),this.state.confirm_dialog!==a.NONE&&T.createElement(Y,{close_sub_dialog:this.close_sub_dialog.bind(this),default_input_value:this.state.tooltip.name,type:this.state.confirm_dialog,id:this.state.tooltip.id})))}}]),t}(T.Component);var ae=Object(O.b)(Object(L.connect)((function(e){return{groups:e.backpack_state.groups,materials:e.backpack_state.materials,load_status:e.backpack_state.load_status,selected_materials:e.backpack_state.selected_materials,selected_group_id:e.backpack_state.selected_group_id}}),(function(e){return Object(U.bindActionCreators)({close_dialog:z.c,show_toast:C.d,action_fetch_bcmps_by_urls:P.d,action_fetch_groups:H.A,action_fetch_materials:H.B,action_clear_backpack_state:H.v,action_set_page:H.K,action_set_materials:H.J,action_set_fetch_current_page:H.E,action_set_selected_materials:H.M,action_set_selected_group_id:H.L,action_clear_selected_materials:H.w},e)}))(ie))}}]);
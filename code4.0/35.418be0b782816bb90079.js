(this.webpackJsonp=this.webpackJsonp||[]).push([[35],{"5PdB":function(e,t,n){"use strict";n.r(t),n.d(t,"CloudVariablePanelComponent",(function(){return S}));var a=n("J4zp"),i=n.n(a),c=n("q1tI"),r=n("/MKj"),l=n("ANjH"),o=n("2OET"),s=n("Gzrk"),d=n("i3Cl"),_=n("iqfz"),b=n("gBpP"),u=n("pp/G"),v=n("e/E2"),m=n("1kS+"),p=n("o0o1"),f=n.n(p),h=n("yXPU"),E=n.n(h),g=n("kNvX"),y=n.n(g),k=n("lvvT"),w=n("nOP+"),x=n("JrHu"),B=n("LG/P"),I=(n("YuEf"),{"./style.scss":{variable_container:"variable_container--2Bql1",info_container:"info_container--3N0jH",info:"info--3wBTE",name_container:"name_container--3RO6u",icn_cv:"icn_cv--3AIQZ",name:"name--13Dnz",properties:"properties--3KyZY",btn:"btn--18jeB",visibility:"visibility--317wd",delete:"delete--2GIaR",force_show:"force_show--1bAG8",value_container:"value_container--1R5kK",label:"label--35ewl"}});var N=c.useState,j=c.useEffect,O=c.useRef;var P=Object(o.b)(Object(r.connect)((function(e){return{cloud_variable_data:e.cloud_variable_state}}))((function(e){var t,n=e.cv,a=null!==(t=e.cloud_variable_data.visible)&&void 0!==t?t:n.visible,r=n.type===d.b.PUBLIC_LIST,l=N(!1),o=i()(l,2),_=o[0],b=o[1],u=O(!1),m=function(){var e=E()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!_){e.next=2;break}return e.abrupt("return");case 2:if(!Object(x.a)()){e.next=5;break}return Object(B.c)(B.a.SHOW_PREVENT_SAVE_TOAST),e.abrupt("return");case 5:return b(!0),Object(v.m)("".concat(r?"云列表":"云变量","-删除")),e.next=9,Object(d.h)(n.id,n.name);case 9:!u.current&&b(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return j((function(){return function(){u.current=!0}}),[]),c.createElement("div",{className:"variable_item th1-bg-hover-6 variable_container--2Bql1"},c.createElement("div",{className:"info_container--3N0jH"},c.createElement("div",{className:"info--3wBTE"},c.createElement("div",{className:"name_container--3RO6u"},c.createElement("span",{className:"icn_cv--3AIQZ"},c.createElement(s.c,{id:Object(d.k)(n.type),size:17,class_name:"th1-text-0 th1-text-s2"})),c.createElement("div",{className:"name--13Dnz"},n.name))),c.createElement("div",{className:"properties--3KyZY"},c.createElement("div",{className:"btn--18jeB delete--2GIaR",onClick:m},c.createElement(s.c,{id:"#iconicon-delete",size:16,class_name:_?"th1-text-t7":"th1-text-0 th1-text-s2",custom_styles:{cursor:_?"not-allowed":"pointer"}})),c.createElement("div",{onClick:function(){if(Object(v.m)("".concat(r?"云列表":"云变量","-").concat(a?"隐藏":"显示")),d.d){var e=d.d.db.get_variable_by_id(n.id);k.a.cloud_variable.set_cloud_variable({variable_id:e.id,visible:!e.visible,edit_type:w.d.VISIBLE})}},className:y()("btn visibility ".concat(d.d.db.get_variable_by_id(n.id).visible?"":"force_show"),I,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},c.createElement(s.c,{id:d.d.db.get_variable_by_id(n.id).visible?"#iconxianshi1":"#iconyincang1",size:16,class_name:"th1-text-0 th1-text-s2"})))))})));n("aZxt");var C=c.useState,T=c.useEffect,L=c.useCallback,R=["assign_db","create_cv","delete_cv","clear_db","sync_cv"],S=Object(o.b)(Object(r.connect)(void 0,(function(e){return Object(l.bindActionCreators)({show_tooltip:b.show_tooltip,hide_tooltip:b.hide_tooltip},e)}))((function(e){var t=e.type,n=e.id,a=e.intl,r=e.show_tooltip,l=e.hide_tooltip,o=C(d.d.db.get_sorted_cloud_variables([d.b.PUBLIC],!0)),b=i()(o,2),p=b[0],f=b[1],h=C(d.d.db.get_sorted_cloud_variables([d.b.PRIVATE],!0)),E=i()(h,2),g=E[0],y=E[1],k=C(d.d.db.get_sorted_cloud_variables([d.b.PUBLIC_LIST],!0)),w=i()(k,2),x=w[0],B=w[1],I=C(!0),N=i()(I,2),j=N[0],O=N[1],S="cloud_variable"!==t,z=L((function(e){S?B(d.d.db.get_sorted_cloud_variables([d.b.PUBLIC_LIST],!0)):(f(d.d.db.get_sorted_cloud_variables([d.b.PUBLIC],!0)),y(d.d.db.get_sorted_cloud_variables([d.b.PRIVATE],!0)))}),[S]);T((function(){return R.forEach((function(e){return d.d.db.add_event_listener(e,z)})),function(){R.forEach((function(e){return d.d.db.remove_event_listener(e,z)}))}}),[z]),T((function(){Blockly.mainWorkspace&&Blockly.mainWorkspace.refresh_toolbox_selection()}));return c.createElement("div",{id:n,className:"cloud_var_panel--2CHKg"},c.createElement("div",{className:"header--ZpGgP"},c.createElement(_.a,{type:"dark",on_click:d.o.bind(void 0,t),width:28,height:28,margin:"0 4px 0 0",on_mouse_enter:function(e){var t=Object(u.c)(e.target),n=t.top,i=t.height,c=t.left,l=t.width;r({x:c+l/2,y:n+i,text:a.formatMessage({id:"cloud_variable/cloudserver"}),type:"left_half"})},on_mouse_leave:function(e){l()}},c.createElement(s.c,{id:"#iconicon_yunfuwuqi",size:16})),c.createElement(_.a,{type:"dark",on_click:function(){return Object(d.p)("cloud_list"===t?d.b.PUBLIC_LIST:d.b.PUBLIC)},width:"calc(100% - 36px)",height:28,margin:"0 0 0 4px"},c.createElement(s.c,{id:"#iconicon_add",size:12}),c.createElement("span",{className:"add_btn_text--2WdQW"},a.formatMessage({id:t})))),j&&c.createElement("div",{className:"th1-border-impt-5 content--1hthY"},S?c.createElement(c.Fragment,null,x.length?c.createElement("div",{className:"subtitle--2v8B5"},"".concat(a.formatMessage({id:"cloud_list"})," ")):null,x.map((function(e){return c.createElement(P,{key:e.id,cv:e})}))):c.createElement(c.Fragment,null,p.length?c.createElement("div",{className:"subtitle--2v8B5"},"".concat(a.formatMessage({id:"cloud_variable/variable_panel/public_variable"})," ")):null,p.map((function(e){return c.createElement(P,{key:e.id,cv:e})})),g.length?c.createElement("div",{className:"subtitle--2v8B5"},"".concat(a.formatMessage({id:"cloud_variable/variable_panel/private_variable"})," ")):null,g.map((function(e){return c.createElement(P,{key:e.id,cv:e})})))),c.createElement(s.h,{has_items:!!(S?x.length:p.length+g.length),is_expanded:j,on_expand_btn_click:function(){Object(v.m)("".concat(S?"云列表":"云变量","-").concat(j?"收起菜单":"展开菜单")),O(!j)}}),c.createElement(m.a,{blockType:"has_sep"}))})))},YuEf:function(e,t,n){e.exports={variable_container:"variable_container--2Bql1",info_container:"info_container--3N0jH",info:"info--3wBTE",name_container:"name_container--3RO6u",icn_cv:"icn_cv--3AIQZ",name:"name--13Dnz",properties:"properties--3KyZY",btn:"btn--18jeB",visibility:"visibility--317wd",delete:"delete--2GIaR",force_show:"force_show--1bAG8",value_container:"value_container--1R5kK",label:"label--35ewl"}},aZxt:function(e,t,n){e.exports={flyout_widget_item_container:"flyout_widget_item_container--2heH8",cloud_var_panel:"cloud_var_panel--2CHKg",add_btn_text:"add_btn_text--2WdQW",header:"header--ZpGgP",subtitle:"subtitle--2v8B5",content:"content--1hthY"}}}]);
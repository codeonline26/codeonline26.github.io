(this.webpackJsonp=this.webpackJsonp||[]).push([[15],{"3KXy":function(e,t,n){"use strict";n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"c",(function(){return x})),n.d(t,"g",(function(){return k})),n.d(t,"b",(function(){return C})),n.d(t,"i",(function(){return S})),n.d(t,"h",(function(){return N})),n.d(t,"a",(function(){return j})),n.d(t,"e",(function(){return R}));var a,r=n("o0o1"),i=n.n(r),o=n("yXPU"),s=n.n(o),c=n("CR6n"),u=n("RShD"),l=n("bBeu"),d=n("ALsR"),m=n("5nG9"),p=n("WFO7"),g=n("e/E2"),_=n("q7c8");function h(e){return v.apply(this,arguments)}function v(){return(v=s()(i.a.mark((function e(t){var n,a,r=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:"GET",a=r.length>2&&void 0!==r[2]?r[2]:{url:t,method:n,withCredentials:!0},e.prev=2,e.next=5,Object(c.a)(a);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0={};case 8:return e.abrupt("return",e.t0);case 11:throw e.prev=11,e.t1=e.catch(2),d.a.get_store().dispatch(Object(m.d)({content:"disconnect_tips",type:"error",timeout:2e3})),e.t1;case 15:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}function f(e){return w.apply(this,arguments)}function w(){return(w=s()(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(Object(p.a)().creation_api,"/kitten/work/detail/").concat(t),e.next=3,h(n);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return y.apply(this,arguments)}function y(){return(y=s()(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(Object(p.a)().creation_api,"/kitten/work/labels"),e.next=3,h(t);case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(){return A.apply(this,arguments)}function A(){return(A=s()(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat(Object(p.a)().creation_api,"/kitten/work/cover/defaultCovers"),e.next=3,h(t);case 3:return n=e.sent,e.abrupt("return",n.items);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return I.apply(this,arguments)}function I(){return(I=s()(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n="".concat(Object(p.a)().creation_api,"/kitten/work/cover/").concat(t,"/recentCovers"),e.next=5,h(n);case 5:return a=e.sent,e.abrupt("return",a.items);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return E.apply(this,arguments)}function E(){return(E=s()(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){Object(u.a)(t,"cover",(function(t){e(t)}),!0).catch((function(e){console.error(e)}))}));case 2:return n=e.sent,e.abrupt("return",n.img?n.img:"");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,n){return O.apply(this,arguments)}function O(){return(O=s()(i.a.mark((function e(t,n,r){var o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n||(n="image/jpg"),e.prev=1,o=new l.a,e.next=5,o.save_to_cdn(t,{file_type:n,bucket:"static",timeout:1e4,file_url_real_time:!0,upload_code:_.i.PROJECT_COVER,on_upload_progress:function(e){!r&&d.a.get_store().dispatch(Object(m.d)({content:"release_dialog/uploading_cover",type:"loading",timeout:!1,get_id:function(e){return a=e},on_close:function(){return a=void 0},disable_intl:!1}))},on_uploaded:function(){!r&&setTimeout((function(){a&&d.a.get_store().dispatch(Object(m.b)(a))}),1e3)}});case 5:return s=e.sent,e.abrupt("return",s);case 9:throw e.prev=9,e.t0=e.catch(1),a&&d.a.get_store().dispatch(Object(m.f)({id:a,content:"upload_error/network_error",type:"error",timeout:2e3,disable_intl:!1})),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function N(e){return M.apply(this,arguments)}function M(){return(M=s()(i.a.mark((function e(t){var n,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t,a="".concat(Object(p.a)().creation_api,"/kitten/r2/work/").concat(t.work_id,"/publish"),r={url:a,method:"PUT",data:n,withCredentials:!0},e.next=6,h(a,"PUT",r);case 6:U(t),e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function j(e){return T.apply(this,arguments)}function T(){return(T=s()(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n="".concat(Object(p.a)().api.host,"/web/works/invite/recommend/").concat(t),a={url:n,method:"POST",data:{id:t},withCredentials:!0},e.next=7,h(n,"POST",a);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function U(e){var t=e.labels,n=e.description,a=e.operation,r=e.fork_enable,i=e.cover_type;t.length&&Object(g.m)("发布-使用作品标签"),n&&Object(g.m)("发布-作品介绍"),a&&Object(g.m)("发布-操作说明"),1===r&&Object(g.m)("发布-允许购买"),0===r&&Object(g.m)("发布-不允许购买"),Object(g.m)(["发布-使用最近使用","发布-使用作品截图","发布-使用默认封面"][i])}function R(e){return D.apply(this,arguments)}function D(){return(D=s()(i.a.mark((function e(t){var n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(Object(p.a)().creation_api,"/collaboration/user/").concat(t),e.next=3,h(n);case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},"5OKS":function(e,t,n){"use strict";n.r(t),n.d(t,"ConvertToExeComponent",(function(){return le}));var a,r=n("o0o1"),i=n.n(r),o=n("yXPU"),s=n.n(o),c=n("lwsE"),u=n.n(c),l=n("W8MJ"),d=n.n(l),m=n("a1gu"),p=n.n(m),g=n("Nsbk"),_=n.n(g),h=n("7W2i"),v=n.n(h),f=n("kNvX"),w=n.n(f),b=n("q1tI"),y=n("ANjH"),x=n("/MKj"),A=n("2OET"),k=n("W134"),I=n("CG87"),C=n("G72A"),E=n("5nG9"),S=n("Gzrk"),O=n("3KXy"),N=n("re/r"),M=n("5IJ9"),j=n("2pfL"),T=n("bdvc"),U=n("e/E2"),R=n("yC70"),D=n("PJYZ"),P=n.n(D),L=n("VQJT"),B=n.n(L),Q=n("BkRI"),F=n.n(Q),V=n("vDqi"),z=n.n(V),K=n("dqaR"),W=n("mQNm"),J=n("bBeu");!function(e){e[e.WAIT=0]="WAIT",e[e.CONVERTING=1]="CONVERTING",e[e.SUCCESS=2]="SUCCESS",e[e.FAIL=3]="FAIL",e[e.INITIAL=4]="INITIAL"}(a||(a={}));var G=function(){var e=s()(i.a.mark((function e(t){var n,a,r,o,s,c,u,l,d,m,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=F()(t),a=new J.a,n.theatre)for(o in r=n.theatre.styles)s=r[o],c=Object(W.O)(s.id),s.url=c&&c.base64_url?c.base64_url:"",s.cdn_url=c?c.cdn_url:void 0,s.base64_url=void 0;if(!n.audio){e.next=25;break}u=n.audio,e.t0=i.a.keys(u);case 6:if((e.t1=e.t0()).done){e.next=25;break}return l=e.t1.value,d=n.audio[l],m=Object(W.C)(l),delete d.base64_url,d.cdn_url=m?m.cdn_url:void 0,e.next=14,a.get_from_indexed_db(l);case 14:if(!(p=e.sent)){e.next=19;break}d.url=p.toString(),e.next=23;break;case 19:if(m&&m.cdn_url){e.next=22;break}return d.url="",e.abrupt("return");case 22:d.url=m.cdn_url;case 23:e.next=6;break;case 25:return e.next=27,Y(n.preview||K.a.get_state().project_state.preview||"");case 27:return n.preview=e.sent,e.abrupt("return",n);case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function Y(e){if(e){var t=z.a.CancelToken.source(),n={url:e,method:"get",responseType:"blob",cancelToken:t.token,timeout:1e4};return z()(n).then(function(){var t=s()(i.a.mark((function t(n){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(200===n.status){t.next=2;break}return t.abrupt("return",e);case 2:return t.next=4,Object(T.c)(n.data);case 4:return a=t.sent,t.abrupt("return",a);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch(function(){var t=s()(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}n("bKe0");var q={"./style.scss":{avatar:"avatar--15wQO","avatar-inside":"avatar-inside--38xrt","avatar-inside-animation":"avatar-inside-animation--3nB6s",gif_cover:"gif_cover--lWu2P",avatar_editor_wrap:"avatar_editor_wrap--vHNN8",scale_bar:"scale_bar--1wzVA",avatar_editor_disabled:"avatar_editor_disabled--2J-Lg",change_cover:"change_cover--1nuqL",icon_wrap:"icon_wrap--3hNaI",exe_name:"exe_name--269iG",zoom_button:"zoom_button--1IClC",zoom_in:"zoom_in--1XOjf",zoom_out:"zoom_out--p9g7g",cover_list:"cover_list--2712U",upload_img:"upload_img--2DUyP",upload_img_input:"upload_img_input--1eADr",cover_list_wrap:"cover_list_wrap--1_2_m",cover_list_section:"cover_list_section--o2arf",title:"title--2GmFc",img_list:"img_list--3K34_",cover_img_wrap:"cover_img_wrap--2XQKr",cover_img:"cover_img--2rRUU"}};var H=function(e){function t(e){var r;return u()(this,t),(r=p()(this,_()(t).call(this,e))).file_input=void 0,r.cover_list=void 0,r.avatar_editor=void 0,r.get_intl_msg=function(e,t){return r.props.intl.formatMessage({id:e},t)},r.init=s()(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=[],a=1;a<=8;a++)t.push(n("Op0n")("./".concat(a,".png")));setTimeout((function(){r.setState({default_covers:t,default_img:r.props.preview})}),100);case 3:case"end":return e.stop()}}),e)}))),r.handle_range_input_change=function(e){r.setState({range_input_value:e.target.value})},r.change_cover=function(e){r.state.show_cover_list||(r.setState({show_cover_list:e}),document.addEventListener("mousedown",r.on_window_mouse_down,!0))},r.on_window_mouse_down=function(e){var t=e.target;r.cover_list.contains(t)||"change_cover"===t.getAttribute("id")||r.hide_cover_list()},r.hide_cover_list=function(){r.setState({show_cover_list:!1}),document.removeEventListener("mousedown",r.on_window_mouse_down)},r.file_filter=function(){var e=s()(i.a.mark((function e(t){var n,a,o,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.o)([t]);case 2:if(n=e.sent,a=n.has_failed_load,o=n.has_oversize_img,s=n.has_unsupported_format,c="",a&&(c="release_dialog/invalid_image"),o&&(c="release_dialog/image_size_notice"),s&&(c="release_dialog/image_type_notice"),!c){e.next=11;break}return r.props.show_toast({content:c,type:"notice"}),e.abrupt("return",!1);case 11:return e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.load_img=function(){var e=s()(i.a.mark((function e(t){var n,a,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.files){e.next=3;break}return e.abrupt("return");case 3:return a=n[0],e.next=6,r.file_filter(a);case 6:if(e.sent){e.next=9;break}return e.abrupt("return");case 9:o=URL.createObjectURL(a),r.setState({display_img:o}),r.hide_cover_list();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.handle_upload_img_click=function(){r.file_input.click()},r.handle_img_click=function(e){r.setState({display_img:e,range_input_value:"1"}),r.hide_cover_list()},r.handle_zoom_button_click=function(e){var t;t="in"===e?1/8:-1/8;var n=parseFloat(r.state.range_input_value)+t;n<1&&(n=1),n>2&&(n=2);var a=n.toString();r.setState({range_input_value:a})},r.get_cover_info=s()(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r.avatar_editor.getImageScaledToCanvas().toDataURL());case 1:case"end":return e.stop()}}),e)}))),r.on_image_change=function(){setTimeout((function(){r.setState({inside_img:r.avatar_editor.getImageScaledToCanvas().toDataURL()})}),100)},r.get_avatar=function(){var e=parseFloat(r.state.range_input_value);return b.createElement("div",{className:w()("avatar_editor_wrap ".concat(r.props.convertStatus!==a.INITIAL?"avatar_editor_disabled":""),q,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},b.createElement(B.a,{crossOrigin:"anonymous",ref:function(e){e&&(r.avatar_editor=e)},image:r.state.display_img||r.state.default_img,width:296,height:296,border:0,scale:e,onLoadSuccess:function(){return r.on_image_change()},onImageChange:function(){return r.on_image_change()}}),r.props.convertStatus===a.INITIAL&&b.createElement("div",{className:"scale_bar--1wzVA"},b.createElement("span",{className:"zoom_button--1IClC zoom_out--p9g7g",onClick:r.handle_zoom_button_click.bind(P()(r),"out")},b.createElement("span",{className:"icon_wrap--3hNaI"},b.createElement(S.c,{id:"#icon_zoom_out",size:13}))),b.createElement("input",{type:"range",step:"0.01",min:"1",max:"2",value:r.state.range_input_value,onChange:r.handle_range_input_change}),b.createElement("span",{className:"zoom_button--1IClC zoom_in--1XOjf",onClick:r.handle_zoom_button_click.bind(P()(r),"in")},b.createElement("span",{className:"icon_wrap--3hNaI"},b.createElement(S.c,{id:"#icon_zoom_in",size:13})))))},r.state={show_cover_list:!1,range_input_value:"1",display_img:"",default_covers:[],inside_img:"",default_img:n("5Zcy")},r}return v()(t,e),d()(t,[{key:"componentDidMount",value:function(){this.init(),this.props.get_avatar(this)}},{key:"render_cover_list_section",value:function(e){var t=this,n=this.props.intl.formatMessage({id:"release_dialog/".concat(e)}),a=[],r="";switch(e){case"screen_shot_cover":a.push(this.props.preview),r="转换为exe格式-作品截图";break;default:a=this.state.default_covers,r="转换为exe格式-默认图片"}return b.createElement("section",{className:"cover_list_section--o2arf"},b.createElement("span",{className:"title--2GmFc"},n),b.createElement("div",{className:"img_list--3K34_"},a.map((function(e,n){return b.createElement("div",{className:"cover_img_wrap--2XQKr",key:n,onClick:t.handle_img_click.bind(t,e),"data-report-click":r},b.createElement("div",{className:"cover_img--2rRUU",style:{backgroundImage:"url(".concat(e,")")}}))}))))}},{key:"render",value:function(){var e=this;return b.createElement("div",{className:"avatar--15wQO"},this.get_avatar(),b.createElement("div",{className:w()("avatar-inside ".concat(this.props.convertStatus===a.CONVERTING?"avatar-inside-animation":""),q,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},b.createElement("img",{src:this.state.inside_img})),this.props.convertStatus===a.INITIAL&&b.createElement("span",{id:"change_cover",className:"change_cover--1nuqL",onClick:this.change_cover.bind(this,!0),"data-report-click":"转换为exe格式-更改logo图片"},b.createElement("span",{className:"icon_wrap--3hNaI"},b.createElement(S.c,{id:"#icon_zaichuangzuo",size:16})),this.get_intl_msg("dialogs/convert_to_exe_dialog/change_work_logo")),(this.props.convertStatus===a.CONVERTING||this.props.convertStatus===a.SUCCESS)&&b.createElement("span",{className:"exe_name--269iG"},this.props.exe_name),this.state.show_cover_list&&b.createElement("div",{id:"cover_list",className:"cover_list--2712U",ref:function(t){t&&(e.cover_list=t)}},b.createElement("div",{className:"upload_img--2DUyP",onClick:this.handle_upload_img_click,"data-report-click":"转换为exe格式-上传"},this.get_intl_msg("dialogs/convert_to_exe_dialog/upload_type")),b.createElement("input",{type:"file",className:"upload_img_input--1eADr",onChange:this.load_img,ref:function(t){t&&(e.file_input=t)},accept:".jpg, .jpeg, .png"}),b.createElement("div",{className:"cover_list_wrap--1_2_m"},this.render_cover_list_section("screen_shot_cover"),this.render_cover_list_section("default_cover"))))}}]),t}(b.Component);var X=Object(A.b)(Object(x.connect)((function(e){var t=e.project_state;return{preview:t.preview,work_id:t.work_id}}),(function(e){return Object(y.bindActionCreators)({show_toast:E.d},e)}))(H)),Z=n("MVZn"),$=n.n(Z),ee=n("9pky"),te=n("WFO7"),ne=n("CR6n");function ae(e){var t={url:"".concat(Object(te.a)().convert_to_exe_api,"/kitten/web/pack"),method:"POST",withCredentials:!0,data:e};return new Promise((function(e){Object(ne.a)(t).then((function(t){e(t)})).catch((function(e){throw e}))}))}function re(){var e={url:"".concat(Object(te.a)().convert_to_exe_api,"/kitten/web/pack/limit"),method:"GET",withCredentials:!0};return new Promise((function(t){Object(ne.a)(e).then((function(e){t(e)})).catch((function(e){throw e}))}))}function ie(e){var t={url:"".concat(Object(te.a)().convert_to_exe_api,"/kitten/web/pack/status"),method:"GET",withCredentials:!0,params:e};return new Promise((function(e){Object(ne.a)(t).then((function(t){e(t)})).catch((function(e){throw e}))}))}function oe(e){return se.apply(this,arguments)}function se(){return(se=s()(i.a.mark((function e(t){var n,a,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(Object(te.a)().creation_api,"/data-center/tracking"),e.t0=Number,e.next=4,Object(ee.a)();case 4:return e.t1=e.sent.user_id,a=(0,e.t0)(e.t1),r={url:n,method:"POST",withCredentials:!0,data:$()({event_id:"format_factory_queue",user_id:a},t)},e.abrupt("return",new Promise((function(e){Object(ne.a)(r).then((function(t){e(t)})).catch((function(e){throw e}))})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}n("BHnV");var ce={"./style.scss":{container:"container--1yAdL",title:"title--Oi-0x","avatar-container":"avatar-container--3ZUzS","avatar-container-end":"avatar-container-end--2i8Ty","avatar-container-animation":"avatar-container-animation--3sr26","exe-logo":"exe-logo--3OSiL","exe-name-container":"exe-name-container--2D_VV","name-title":"name-title--2jcfw","name-input":"name-input--10YtM","name-tips":"name-tips--1inId","convert-success-msg":"convert-success-msg--s4aO_","convert-fail-msg":"convert-fail-msg--yaZAQ","exe-btn-container":"exe-btn-container--38U3C",progress:"progress--UrC1l","progress-number":"progress-number--2jGu_","progress-bar-bg":"progress-bar-bg--3wYs6","progress-bar":"progress-bar--3QGms","progress-msg":"progress-msg--3GsB7","loading-dot":"loading-dot--1vm3O","minimum-btn":"minimum-btn--6sHS4","convert-times":"convert-times--1BPyv","convert-times-tips":"convert-times-tips--1VBr0",tips:"tips--bxRbs","minimum-toast":"minimum-toast--2CiVS","toast-left":"toast-left--3F1-K","toast-middle":"toast-middle--3Qo70",show:"show--1-348",close:"close--Dxyv7"}};var ue=function(e){function t(e){var n;return u()(this,t),(n=p()(this,_()(t).call(this,e))).avatar=void 0,n.input_el=void 0,n.origin_wait_num=void 0,n.convert_task_id=void 0,n.download_url=void 0,n.progressInterval=void 0,n.waitInterval=void 0,n.dotInterval=void 0,n.uploadInterval=void 0,n.has_report=void 0,n.on_request_close=function(){n.has_report||(Object(U.m)("格式工厂-关闭"),n.has_report=!0,setTimeout((function(){n.has_report=!1}),300)),n.props.close_dialog({dialog_type:"convert_to_exe"})},n.get_intl_msg=function(e,t){return n.props.intl.formatMessage({id:e},t)},n.get_avatar=function(e){n.avatar=e},n.set_progress=function(e,t){var a=n.state.progressNum,r=10+Math.floor((n.origin_wait_num-e)/n.origin_wait_num*50+Math.floor(.4*t));r=r>=100?100:r,clearInterval(n.progressInterval),n.progressInterval=setInterval((function(){a>r||a>=100?clearInterval(n.progressInterval):(a++,n.setState({progressNum:a}))}),100)},n.loading=s()(i.a.mark((function e(){var t,r,o,c,u,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie({task_id:n.convert_task_id});case 2:if((t=e.sent).data){e.next=7;break}return n.setState({convertStatus:a.FAIL}),clearInterval(n.dotInterval),e.abrupt("return");case 7:r=t.data.queue_len||0,o=t.data.progress,-1===r&&(r=201),n.origin_wait_num=r+1,oe(r>200?{event_type:"queue_len",value:-1}:{event_type:"queue_len",value:r}),oe({event_type:"queue_time",value:c=90*Math.ceil((r+1)/3)}),n.setState({current_wait_num:r,remain_sec:c},(function(){return n.set_progress(r,0)})),u=r,l=o,n.waitInterval=setInterval(s()(i.a.mark((function e(){var t,r,o,s,c,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ie({task_id:n.convert_task_id});case 2:if(t=e.sent,r=t.data,o=r.status,s=r.progress,c=r.download_url,-1===(d=t.data.queue_len||0)&&(d=201),0===u?l=s:u=d,!(n.state.progressNum>=100||o===a.FAIL||o===a.SUCCESS)){e.next=13;break}return n.setState({progressNum:100,convertStatus:c?a.SUCCESS:a.FAIL}),n.download_url=c||"",o===a.SUCCESS&&n.state.remain_times-n.state.wait_task_number<=0&&Object(U.m)("格式工厂-转换次数归零"),clearInterval(n.waitInterval),e.abrupt("return");case 13:n.set_progress(u,l),n.setState({current_wait_num:u,remain_sec:90*Math.ceil((u+1)/3)});case 15:case"end":return e.stop()}}),e)}))),5e3);case 18:case"end":return e.stop()}}),e)}))),n.convert=s()(i.a.mark((function e(){var t,r,o,s,c,u,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.state.new_exe_name){e.next=4;break}return n.props.show_toast({content:"dialogs/convert_to_exe_dialog/exe_name_empty"}),n.input_el&&n.input_el.focus(),e.abrupt("return");case 4:if(n.props.work_id){e.next=6;break}return e.abrupt("return");case 6:return n.setState({is_converting:!0,convertStatus:a.CONVERTING,remain_times:n.state.remain_times-1}),r=1,n.uploadInterval=setInterval((function(){r>=10&&clearInterval(n.uploadInterval),n.setState({progressNum:r}),r++}),1e3),o=n.state.loadingDot,n.dotInterval=setInterval((function(){n.state.progressNum>=100?clearInterval(n.dotInterval):(o=o.length>=3?".":"".concat(o,"."),n.setState({loadingDot:o}))}),1e3),e.next=13,n.get_bcmc_url(n.state.new_exe_name);case 13:if(s=e.sent){e.next=19;break}return n.setState({convertStatus:a.FAIL}),clearInterval(n.dotInterval),clearInterval(n.uploadInterval),e.abrupt("return");case 19:return e.next=21,n.avatar.get_cover_info();case 21:if(c=e.sent,u="",!c){e.next=27;break}return e.next=26,n.get_exe_logo(c);case 26:u=e.sent;case 27:return s=Object(T.N)(s),e.next=30,ae({bcmc_url:s,work_id:n.props.work_id,icon_url:u,name:n.state.new_exe_name});case 30:if(l=e.sent,n.convert_task_id=null==l||null===(t=l.data)||void 0===t?void 0:t.task_id,clearInterval(n.uploadInterval),n.convert_task_id){e.next=37;break}return n.setState({convertStatus:a.FAIL}),clearInterval(n.dotInterval),e.abrupt("return");case 37:n.loading();case 38:case"end":return e.stop()}}),e)}))),n.get_exe_logo=function(){var e=s()(i.a.mark((function e(t){var n,a,r,o,s,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=/^data:(image\/[\s\S]*)?;base64,/,r=(n=t).match(a),o=r&&r[1],s=n,e.next=8,Object(O.i)(s,o,!0);case 8:return c=e.sent,e.abrupt("return",c);case 12:throw e.prev=12,e.t0=e.catch(0),e.t0;case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),n.get_bcmc_url=function(){var e=s()(i.a.mark((function e(t){var a,r,o,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(M.generate_bcmc)(),e.next=3,G(a);case 3:if(a=e.sent,r=JSON.stringify(a).length,!((o=Math.ceil(r/1024/1024))>29)){e.next=9;break}return n.setState({work_size:o}),e.abrupt("return","");case 9:return e.next=11,Object(N.i)(a,t||a.project_name,!0);case 11:return s=e.sent,e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handle_name_input_change=function(e){var t;n.setState({new_exe_name:null===(t=e.target)||void 0===t?void 0:t.value})},n.handle_name_input_blur=function(e){var t;if(null===(t=e.target)||void 0===t?void 0:t.value){var a=Object(j.e)(e.target.value,n.state.old_exe_name);n.setState({old_exe_name:a.name,new_exe_name:a.name})}else n.setState({new_exe_name:n.state.old_exe_name})},n.state={convertStatus:a.INITIAL,loadingDot:".",progressNum:0,new_exe_name:e.work_name,old_exe_name:e.work_name,current_wait_num:0,remain_sec:0,remain_times:0,wait_task_number:0,is_converting:!1,show_minimum_toast:!1,show_avatar_container_animation:!0,work_size:0},n.has_report=!1,n}var n;return v()(t,e),d()(t,[{key:"componentDidMount",value:(n=s()(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(U.L)(),e.next=3,re();case 3:(t=e.sent).data&&this.setState({remain_times:t.data.amount_nums||0,wait_task_number:t.data.queuing_task_nums||0});case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){var e,t;Object(U.o)(),this.convert_task_id&&(e={task_id:this.convert_task_id},t={url:"".concat(Object(te.a)().convert_to_exe_api,"/kitten/web/pack/stop"),method:"PUT",withCredentials:!0,params:e},new Promise((function(e){Object(ne.a)(t).then((function(t){e(t)})).catch((function(e){throw e}))}))),clearInterval(this.progressInterval),clearInterval(this.dotInterval),clearInterval(this.waitInterval),clearInterval(this.uploadInterval)}},{key:"download_exe",value:function(){if(this.download_url){var e=document.createElement("a");e.download="".concat(this.state.new_exe_name,".exe"),e.style.display="none",e.href=this.download_url,document.body.appendChild(e),e.click(),document.body.removeChild(e)}}},{key:"retry",value:function(){this.reset(),this.convert()}},{key:"reset",value:function(){this.origin_wait_num=0,this.convert_task_id="",this.download_url="",this.setState({loadingDot:".",progressNum:0,current_wait_num:0,remain_sec:0,remain_times:0,is_converting:!1,wait_task_number:0,show_minimum_toast:!1,show_avatar_container_animation:!0})}},{key:"set_minimum",value:function(e){e?Object(R.b)():Object(R.a)(),document.getElementsByClassName("old-k4-dialog")[0].style.display=e?"none":"flex",this.setState({show_minimum_toast:e,show_avatar_container_animation:!1})}},{key:"get_progress_msg",value:function(){var e=this.state,t=e.current_wait_num,n=e.remain_sec,a=e.progressNum,r=e.loadingDot;return a<=10?b.createElement(b.Fragment,null,this.get_intl_msg("dialogs/convert_to_exe_dialog/uploading_tips"),b.createElement("span",{className:"loading-dot--1vm3O"},r)):0===t?b.createElement(b.Fragment,null,this.get_intl_msg("dialogs/convert_to_exe_dialog/converting_tips",{sec:Math.floor((100-a)/50*90)}),b.createElement("span",{className:"loading-dot--1vm3O"},r)):t>200?this.get_intl_msg("dialogs/convert_to_exe_dialog/wait_max_tips"):this.get_intl_msg("dialogs/convert_to_exe_dialog/wait_tips",{number:t,min:Math.floor(n/60)})}},{key:"render",value:function(){var e=this,t=this.state,n=t.convertStatus,r=t.loadingDot,i=t.progressNum,o=t.new_exe_name,s=t.remain_times,c=t.is_converting,u=t.wait_task_number,l=t.show_minimum_toast,d=t.show_avatar_container_animation,m=t.work_size;return b.createElement("div",null,b.createElement(I.a,{type:"convert_to_exe",on_request_close:this.on_request_close,close_btn:!0},b.createElement("div",{className:"container--1yAdL"},b.createElement("div",{className:"title--Oi-0x"},this.get_intl_msg("dialogs/convert_to_exe_dialog/convert_to_exe")),n===a.INITIAL&&b.createElement("div",{className:"exe-logo--3OSiL"},this.get_intl_msg("dialogs/convert_to_exe_dialog/exe_work_logo")),b.createElement("div",{className:w()("".concat(d&&n===a.INITIAL?"avatar-container":d?"avatar-container-animation":"avatar-container-end"),ce,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},b.createElement(X,{exe_name:o,get_avatar:this.get_avatar,convertStatus:n})),n===a.INITIAL&&b.createElement("div",{className:"exe-name-container--2D_VV"},b.createElement("div",{className:"name-title--2jcfw"},this.get_intl_msg("dialogs/convert_to_exe_dialog/exe_work_name")),b.createElement("div",{className:"name-input--10YtM"},b.createElement(S.d,{autofocus:!0,get_input_el:function(t){e.input_el=t},width:"296px",height:"36px",max_length:20,placeholder:"dialogs/convert_to_exe_dialog/exe_work_name_placeholder",value:this.state.new_exe_name,on_blur:this.handle_name_input_blur,on_change:this.handle_name_input_change})),b.createElement("div",{className:"name-tips--1inId"},this.get_intl_msg("dialogs/convert_to_exe_dialog/exe_match_system"))),(n===a.CONVERTING||n===a.WAIT)&&b.createElement(b.Fragment,null,b.createElement("div",{className:"progress--UrC1l"},b.createElement("div",{className:"progress-number--2jGu_"},"".concat(i,"%")),b.createElement("div",{className:"progress-bar-bg--3wYs6"},b.createElement("div",{className:"progress-bar--3QGms",style:{width:"".concat(i,"%")}})),b.createElement("div",{className:"progress-msg--3GsB7"},this.get_progress_msg())),b.createElement("div",{className:"minimum-btn--6sHS4"},b.createElement(S.a,{type:"primary-outline",width:110,height:36,margin:"0 0 -16px 0",on_click:function(){return e.set_minimum(!0)},data_report:"格式工厂-最小化"},b.createElement("span",null,this.get_intl_msg("dialogs/convert_to_exe_dialog/minimum_convert_minimum"))))),n===a.SUCCESS&&b.createElement("div",{className:"convert-success-msg--s4aO_"},this.get_intl_msg("dialogs/convert_to_exe_dialog/convert_success")),n===a.FAIL&&b.createElement("div",{className:"convert-fail-msg--yaZAQ"},m>29?this.get_intl_msg("dialogs/convert_to_exe_dialog/work_too_large",{size:m}):this.get_intl_msg("dialogs/convert_to_exe_dialog/convert_fail")),n!==a.CONVERTING&&n!==a.WAIT&&b.createElement("div",{className:"exe-btn-container--38U3C"},n===a.INITIAL&&b.createElement(S.a,{type:"primary",width:110,height:36,margin:"0 0 -16px 0",disable:c||s-u<=0,data_report:"格式工厂-转换",on_click:function(){return e.convert()}},b.createElement("span",null,this.get_intl_msg("dialogs/convert_to_exe_dialog/convert"))),n===a.SUCCESS&&b.createElement(S.a,{type:"primary",width:110,height:36,data_report:"格式工厂-下载",on_click:function(){return e.download_exe()}},b.createElement("span",null,this.get_intl_msg("dialogs/convert_to_exe_dialog/download"))),n===a.FAIL&&b.createElement(b.Fragment,null,b.createElement(S.a,{type:"primary-outline",width:110,height:36,margin:"0 16px 0 0",data_report:"转换为exe格式-取消",on_click:function(){return e.on_request_close()}},b.createElement("span",null,this.get_intl_msg("dialogs/convert_to_exe_dialog/cancel"))),b.createElement(S.a,{type:"primary",width:110,height:36,data_report:"转换为exe格式-重试",on_click:function(){return e.retry()}},b.createElement("span",null,this.get_intl_msg("dialogs/convert_to_exe_dialog/retry"))))),n===a.INITIAL&&b.createElement("div",{className:"convert-times--1BPyv"},b.createElement("span",null,this.get_intl_msg("dialogs/convert_to_exe_dialog/convert_times_left",{times:s-u})),b.createElement("div",{className:"convert-times-tips--1VBr0"},b.createElement(S.c,{id:"#icon_chaxun",size:12}),b.createElement("div",{className:"tips--bxRbs"},this.get_intl_msg("dialogs/convert_to_exe_dialog/convert_times_tips")))))),l&&b.createElement("div",{className:w()("minimum-toast ".concat(l?"show":"close"),ce,{autoResolveMultipleImports:!0,handleMissingStyleName:"warn"})},b.createElement("div",{className:"toast-left--3F1-K"},(n===a.CONVERTING||n===a.WAIT)&&b.createElement(k.a,{progress:i,size:"26",lineWidth:"30",showPercentageSymbol:!1,bgColor:"rgba(var(--theme-color-t1), 1)",textColor:"rgba(var(--theme-color-0), 1)",progressColor:"rgba(var(--theme-color-0), 1)",textStyle:{font:"bold 12rem NotoSansCJKsc, sans-serif"}}),n===a.SUCCESS&&b.createElement(S.c,{id:"#iconalert_donex",size:20}),n===a.FAIL&&b.createElement(S.c,{id:"#iconalert_errorx",size:20})),b.createElement("div",{className:"toast-middle--3Qo70"},(n===a.CONVERTING||n===a.WAIT)&&b.createElement("div",{className:"progress-msg--3GsB7"},this.get_intl_msg("dialogs/convert_to_exe_dialog/minimum_converting"),b.createElement("span",{className:"loading-dot--1vm3O"},r)),n===a.SUCCESS&&b.createElement("span",null,this.get_intl_msg("dialogs/convert_to_exe_dialog/minimum_convert_success")),n===a.FAIL&&b.createElement("span",null,this.get_intl_msg("dialogs/convert_to_exe_dialog/minimum_convert_fail"))),b.createElement("div",{className:""},b.createElement(S.a,{type:"light",margin:"0 0 3px 0",id:"convert-to-exe-minimum-btn",on_click:function(){return e.set_minimum(!1)}},b.createElement("span",null,n===a.SUCCESS?this.get_intl_msg("dialogs/convert_to_exe_dialog/minimum_convert_download"):this.get_intl_msg("dialogs/convert_to_exe_dialog/minimum_convert_show"))))))}}]),t}(b.Component),le=Object(A.b)(Object(x.connect)((function(e){return{work_name:e.project_state.work_name,work_id:e.project_state.work_id}}),(function(e){return Object(y.bindActionCreators)({close_dialog:C.c,show_toast:E.d,hide_toast:E.b},e)}))(ue))},"5Zcy":function(e,t){e.exports="data:image/png;base64,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"},"8Rux":function(e,t){e.exports="../build/asset/1_ca287.png"},BHnV:function(e,t,n){e.exports={container:"container--1yAdL",title:"title--Oi-0x","avatar-container":"avatar-container--3ZUzS","avatar-container-end":"avatar-container-end--2i8Ty","avatar-container-animation":"avatar-container-animation--3sr26","exe-logo":"exe-logo--3OSiL","exe-name-container":"exe-name-container--2D_VV","name-title":"name-title--2jcfw","name-input":"name-input--10YtM","name-tips":"name-tips--1inId","convert-success-msg":"convert-success-msg--s4aO_","convert-fail-msg":"convert-fail-msg--yaZAQ","exe-btn-container":"exe-btn-container--38U3C",progress:"progress--UrC1l","progress-number":"progress-number--2jGu_","progress-bar-bg":"progress-bar-bg--3wYs6","progress-bar":"progress-bar--3QGms","progress-msg":"progress-msg--3GsB7","loading-dot":"loading-dot--1vm3O","minimum-btn":"minimum-btn--6sHS4","convert-times":"convert-times--1BPyv","convert-times-tips":"convert-times-tips--1VBr0",tips:"tips--bxRbs","minimum-toast":"minimum-toast--2CiVS","toast-left":"toast-left--3F1-K","toast-middle":"toast-middle--3Qo70",show:"show--1-348",close:"close--Dxyv7"}},OFMA:function(e,t){e.exports="../build/asset/2_97071.png"},Op0n:function(e,t,n){var a={"./1.png":"8Rux","./2.png":"OFMA","./3.png":"Qz5O","./4.png":"cj50","./5.png":"W4Ee","./6.png":"ihNr","./7.png":"SM+y","./8.png":"THjs","./default.png":"5Zcy"};function r(e){var t=i(e);return n(t)}function i(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}r.keys=function(){return Object.keys(a)},r.resolve=i,e.exports=r,r.id="Op0n"},Qz5O:function(e,t){e.exports="../build/asset/3_d5d9e.png"},"SM+y":function(e,t){e.exports="../build/asset/7_db1cc.png"},THjs:function(e,t){e.exports="../build/asset/8_58558.png"},VQJT:function(e,t,n){e.exports=function(e,t,n){"use strict";function a(e,t){return new Promise((function(n,a){var r,i=new Image;i.onload=function(){return n(i)},i.onerror=a,0==(null!==(r=e)&&!!r.match(/^\s*data:([a-z]+\/[a-z]+(;[a-z-]+=[a-z-]+)?)?(;base64)?,[a-z0-9!$&',()*+;=\-._~:@/?%\s]*\s*$/i))&&t&&(i.crossOrigin=t),i.src=e}))}e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,n=n&&n.hasOwnProperty("default")?n.default:n;var r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},u=function(e){var t=!1;return{promise:new Promise((function(n,a){e.then((function(e){return t?a({isCanceled:!0}):n(e)}),(function(e){return a(t?{isCanceled:!0}:e)}))})),cancel:function(){t=!0}}},l=!("undefined"==typeof window||"undefined"==typeof navigator||!("ontouchstart"in window||navigator.msMaxTouchPoints>0)),d="undefined"!=typeof File,m={touch:{react:{down:"onTouchStart",mouseDown:"onMouseDown",drag:"onTouchMove",move:"onTouchMove",mouseMove:"onMouseMove",up:"onTouchEnd",mouseUp:"onMouseUp"},native:{down:"touchstart",mouseDown:"mousedown",drag:"touchmove",move:"touchmove",mouseMove:"mousemove",up:"touchend",mouseUp:"mouseup"}},desktop:{react:{down:"onMouseDown",drag:"onDragOver",move:"onMouseMove",up:"onMouseUp"},native:{down:"mousedown",drag:"dragStart",move:"mousemove",up:"mouseup"}}},p=l?m.touch:m.desktop,g="undefined"!=typeof window&&window.devicePixelRatio?window.devicePixelRatio:1,_={x:.5,y:.5},h=function(e){function m(){var e,t,n;r(this,m);for(var a=arguments.length,i=Array(a),c=0;c<a;c++)i[c]=arguments[c];return t=n=s(this,(e=m.__proto__||Object.getPrototypeOf(m)).call.apply(e,[this].concat(i))),n.state={drag:!1,my:null,mx:null,image:_},n.handleImageReady=function(e){var t=n.getInitialSize(e.width,e.height);t.resource=e,t.x=.5,t.y=.5,n.setState({drag:!1,image:t},n.props.onImageReady),n.props.onLoadSuccess(t)},n.clearImage=function(){var e=n.canvas;e.getContext("2d").clearRect(0,0,e.width,e.height),n.setState({image:_})},n.handleMouseDown=function(e){(e=e||window.event).preventDefault(),n.setState({drag:!0,mx:null,my:null})},n.handleMouseUp=function(){n.state.drag&&(n.setState({drag:!1}),n.props.onMouseUp())},n.handleMouseMove=function(e){if(e=e||window.event,!1!==n.state.drag){e.preventDefault();var t=e.targetTouches?e.targetTouches[0].pageX:e.clientX,a=e.targetTouches?e.targetTouches[0].pageY:e.clientY,r={mx:t,my:a},i=n.props.rotate;if(i=(i%=360)<0?i+360:i,n.state.mx&&n.state.my){var s=n.state.mx-t,c=n.state.my-a,u=n.state.image.width*n.props.scale,l=n.state.image.height*n.props.scale,d=n.getCroppingRect(),m=d.x,p=d.y;m*=u,p*=l;var g=function(e){return e*(Math.PI/180)},_=Math.cos(g(i)),h=Math.sin(g(i)),v=p+-s*h+c*_,f={x:(m+s*_+c*h)/u+1/n.props.scale*n.getXScale()/2,y:v/l+1/n.props.scale*n.getYScale()/2};n.props.onPositionChange(f),r.image=o({},n.state.image,f)}n.setState(r),n.props.onMouseMove(e)}},n.setCanvas=function(e){n.canvas=e},s(n,t)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(m,t.Component),i(m,[{key:"componentDidMount",value:function(){this.props.disableHiDPIScaling&&(g=1);var e=n.findDOMNode(this.canvas).getContext("2d");if(this.props.image&&this.loadImage(this.props.image),this.paint(e),document){var t=!!function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(t){e=!1}return e}()&&{passive:!1},a=p.native;document.addEventListener(a.move,this.handleMouseMove,t),document.addEventListener(a.up,this.handleMouseUp,t),l&&(document.addEventListener(a.mouseMove,this.handleMouseMove,t),document.addEventListener(a.mouseUp,this.handleMouseUp,t))}}},{key:"componentWillReceiveProps",value:function(e){e.image&&this.props.image!==e.image||this.props.width!==e.width||this.props.height!==e.height?this.loadImage(e.image):e.image||this.clearImage()}},{key:"componentDidUpdate",value:function(e,t){var a=n.findDOMNode(this.canvas),r=a.getContext("2d");r.clearRect(0,0,a.width,a.height),this.paint(r),this.paintImage(r,this.state.image,this.props.border),e.image===this.props.image&&e.width===this.props.width&&e.height===this.props.height&&e.position===this.props.position&&e.scale===this.props.scale&&e.rotate===this.props.rotate&&t.my===this.state.my&&t.mx===this.state.mx&&t.image.x===this.state.image.x&&t.image.y===this.state.image.y||this.props.onImageChange()}},{key:"componentWillUnmount",value:function(){if(document){var e=p.native;document.removeEventListener(e.move,this.handleMouseMove,!1),document.removeEventListener(e.up,this.handleMouseUp,!1),l&&(document.removeEventListener(e.mouseMove,this.handleMouseMove,!1),document.removeEventListener(e.mouseUp,this.handleMouseUp,!1))}}},{key:"isVertical",value:function(){return this.props.rotate%180!=0}},{key:"getBorders",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.border;return Array.isArray(e)?e:[e,e]}},{key:"getDimensions",value:function(){var e=this.props,t=e.width,n=e.height,a=e.rotate,r=e.border,i={},o=this.getBorders(r),s=c(o,2),u=s[0],l=s[1],d=t,m=n;return this.isVertical()?(i.width=m,i.height=d):(i.width=d,i.height=m),i.width+=2*u,i.height+=2*l,{canvas:i,rotate:a,width:t,height:n,border:r}}},{key:"getImage",value:function(){var e=this.getCroppingRect(),t=this.state.image;e.x*=t.resource.width,e.y*=t.resource.height,e.width*=t.resource.width,e.height*=t.resource.height;var n=document.createElement("canvas");this.isVertical()?(n.width=e.height,n.height=e.width):(n.width=e.width,n.height=e.height);var a=n.getContext("2d");return a.translate(n.width/2,n.height/2),a.rotate(this.props.rotate*Math.PI/180),a.translate(-n.width/2,-n.height/2),this.isVertical()&&a.translate((n.width-n.height)/2,(n.height-n.width)/2),a.drawImage(t.resource,-e.x,-e.y),n}},{key:"getImageScaledToCanvas",value:function(){var e=this.getDimensions(),t=e.width,n=e.height,a=document.createElement("canvas");return this.isVertical()?(a.width=n,a.height=t):(a.width=t,a.height=n),this.paintImage(a.getContext("2d"),this.state.image,0,1),a}},{key:"getXScale",value:function(){var e=this.props.width/this.props.height,t=this.state.image.width/this.state.image.height;return Math.min(1,e/t)}},{key:"getYScale",value:function(){var e=this.props.height/this.props.width,t=this.state.image.height/this.state.image.width;return Math.min(1,e/t)}},{key:"getCroppingRect",value:function(){var e=this.props.position||{x:this.state.image.x,y:this.state.image.y},t=1/this.props.scale*this.getXScale(),n=1/this.props.scale*this.getYScale(),a={x:e.x-t/2,y:e.y-n/2,width:t,height:n},r=0,i=1-a.width,s=0,c=1-a.height;return(this.props.disableBoundaryChecks||t>1||n>1)&&(r=-a.width,i=1,s=-a.height,c=1),o({},a,{x:Math.max(r,Math.min(a.x,i)),y:Math.max(s,Math.min(a.y,c))})}},{key:"loadImage",value:function(e){var t;d&&e instanceof File?this.loadingImage=u((t=e,new Promise((function(e,n){var r=new FileReader;r.onload=function(t){try{var r=a(t.target.result);e(r)}catch(t){n(t)}},r.readAsDataURL(t)})))).promise.then(this.handleImageReady).catch(this.props.onLoadFailure):"string"==typeof e&&(this.loadingImage=u(a(e,this.props.crossOrigin)).promise.then(this.handleImageReady).catch(this.props.onLoadFailure))}},{key:"getInitialSize",value:function(e,t){var n=void 0,a=void 0,r=this.getDimensions();return r.height/r.width>t/e?a=e*((n=this.getDimensions().height)/t):n=t*((a=this.getDimensions().width)/e),{height:n,width:a}}},{key:"paintImage",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g;if(t.resource){var r=this.calculatePosition(t,n);e.save(),e.translate(e.canvas.width/2,e.canvas.height/2),e.rotate(this.props.rotate*Math.PI/180),e.translate(-e.canvas.width/2,-e.canvas.height/2),this.isVertical()&&e.translate((e.canvas.width-e.canvas.height)/2,(e.canvas.height-e.canvas.width)/2),e.scale(a,a),e.globalCompositeOperation="destination-over",e.drawImage(t.resource,r.x,r.y,r.width,r.height),e.restore()}}},{key:"calculatePosition",value:function(e,t){e=e||this.state.image;var n=this.getBorders(t),a=c(n,2),r=a[0],i=a[1],o=this.getCroppingRect(),s=e.width*this.props.scale,u=e.height*this.props.scale,l=-o.x*s,d=-o.y*u;return this.isVertical()?(l+=i,d+=r):(l+=r,d+=i),{x:l,y:d,height:u,width:s}}},{key:"paint",value:function(e){e.save(),e.scale(g,g),e.translate(0,0),e.fillStyle="rgba("+this.props.color.slice(0,4).join(",")+")";var t=this.props.borderRadius,n=this.getDimensions(),a=this.getBorders(n.border),r=c(a,2),i=r[0],o=r[1],s=n.canvas.height,u=n.canvas.width;t=Math.max(t,0),t=Math.min(t,u/2-i,s/2-o),e.beginPath(),function(e,t,n,a,r,i){if(0===i)e.rect(t,n,a,r);else{var o=a-i,s=r-i;e.translate(t,n),e.arc(i,i,i,Math.PI,1.5*Math.PI),e.lineTo(o,0),e.arc(o,i,i,1.5*Math.PI,2*Math.PI),e.lineTo(a,s),e.arc(o,s,i,2*Math.PI,.5*Math.PI),e.lineTo(i,r),e.arc(i,s,i,.5*Math.PI,Math.PI),e.translate(-t,-n)}}(e,i,o,u-2*i,s-2*o,t),e.rect(u,0,-u,s),e.fill("evenodd"),e.restore()}},{key:"render",value:function(){var e=this.props,n=(e.scale,e.rotate,e.image,e.border,e.borderRadius,e.width,e.height,e.position,e.color,e.style),a=(e.crossOrigin,e.onLoadFailure,e.onLoadSuccess,e.onImageReady,e.onImageChange,e.onMouseUp,e.onMouseMove,e.onPositionChange,e.disableBoundaryChecks,e.disableHiDPIScaling,function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(e,["scale","rotate","image","border","borderRadius","width","height","position","color","style","crossOrigin","onLoadFailure","onLoadSuccess","onImageReady","onImageChange","onMouseUp","onMouseMove","onPositionChange","disableBoundaryChecks","disableHiDPIScaling"])),r=this.getDimensions(),i={width:r.canvas.width,height:r.canvas.height,cursor:this.state.drag?"grabbing":"grab",touchAction:"none"},s={width:r.canvas.width*g,height:r.canvas.height*g,style:o({},i,n)};return s[p.react.down]=this.handleMouseDown,l&&(s[p.react.mouseDown]=this.handleMouseDown),t.createElement("canvas",o({ref:this.setCanvas},s,a))}}]),m}();return h.propTypes={scale:e.number,rotate:e.number,image:e.oneOfType([e.string].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(d?[e.instanceOf(File)]:[]))),border:e.oneOfType([e.number,e.arrayOf(e.number)]),borderRadius:e.number,width:e.number,height:e.number,position:e.shape({x:e.number,y:e.number}),color:e.arrayOf(e.number),crossOrigin:e.oneOf(["","anonymous","use-credentials"]),onLoadFailure:e.func,onLoadSuccess:e.func,onImageReady:e.func,onImageChange:e.func,onMouseUp:e.func,onMouseMove:e.func,onPositionChange:e.func,disableBoundaryChecks:e.bool,disableHiDPIScaling:e.bool},h.defaultProps={scale:1,rotate:0,border:25,borderRadius:0,width:200,height:200,color:[0,0,0,.5],onLoadFailure:function(){},onLoadSuccess:function(){},onImageReady:function(){},onImageChange:function(){},onMouseUp:function(){},onMouseMove:function(){},onPositionChange:function(){},disableBoundaryChecks:!1,disableHiDPIScaling:!1},h}(n("17x9"),n("q1tI"),n("i8i4"))},W4Ee:function(e,t){e.exports="../build/asset/5_10f31.png"},bKe0:function(e,t,n){e.exports={avatar:"avatar--15wQO","avatar-inside":"avatar-inside--38xrt","avatar-inside-animation":"avatar-inside-animation--3nB6s",gif_cover:"gif_cover--lWu2P",avatar_editor_wrap:"avatar_editor_wrap--vHNN8",scale_bar:"scale_bar--1wzVA",avatar_editor_disabled:"avatar_editor_disabled--2J-Lg",change_cover:"change_cover--1nuqL",icon_wrap:"icon_wrap--3hNaI",exe_name:"exe_name--269iG",zoom_button:"zoom_button--1IClC",zoom_in:"zoom_in--1XOjf",zoom_out:"zoom_out--p9g7g",cover_list:"cover_list--2712U",upload_img:"upload_img--2DUyP",upload_img_input:"upload_img_input--1eADr",cover_list_wrap:"cover_list_wrap--1_2_m",cover_list_section:"cover_list_section--o2arf",title:"title--2GmFc",img_list:"img_list--3K34_",cover_img_wrap:"cover_img_wrap--2XQKr",cover_img:"cover_img--2rRUU"}},cj50:function(e,t){e.exports="../build/asset/4_e669a.png"},ihNr:function(e,t){e.exports="../build/asset/6_b2b00.png"}}]);